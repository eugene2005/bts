!function(e,o,u){function s(e){}function t(e,o,t){for(this.callback=t||s,this.errors=[],this.fields={},this.form=this._formByNameOrNode(e)||{},this.messages={},this.handlers={},e=0,t=o.length;e<t;e++){var n=o[e];if((n.name||n.names)&&n.rules)if(n.names)for(var i=0;i<n.names.length;i++)this._addField(n,n.names[i]);else this._addField(n,n.name)}var a,r=this.form.onsubmit;this.form.onsubmit=(a=this,function(e){try{return a._validateForm(e)&&(r===u||r())}catch(e){}})}function i(e,o){var t;if(!(0<e.length)||"radio"!==e[0].type&&"checkbox"!==e[0].type)return e[o];for(t=0;t<e.length;t++)if(e[t].checked)return e[t][o]}var p={required:"The %s field is required.",valid_phoneno:"The %s field is not valid.",matches:"The %s field does not match the %s field.",default:"The %s field is still set to default, please change.",valid_email:"The %s field must contain a valid email address.",valid_emails:"The %s field must contain all valid email addresses.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",alpha_numeric_dash_combo:"The %s field must contain only combination of alpha-numeric characters and dashes.",alphanumeric_combo:"The %s field must contain only combination of alpha-numeric characters.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer.",decimal:"The %s field must contain a decimal number.",is_natural:"The %s field must contain only positive numbers.",is_natural_no_zero:"The %s field must contain a number greater than zero.",valid_ip:"The %s field must contain a valid IP.",valid_base64:"The %s field must contain a base64 string.",valid_credit_card:"The %s field must contain a valid credit card number.",is_file_type:"The %s field must contain only %s files.",valid_url:"The %s field must contain a valid URL.",valid_ca_zip:"The %s field must contain a valid Postal Code."},n=/^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} *\d{1}[A-Z]{1}\d{1}$/,a=/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{1,14}$/,d=/^(.+?)\[(.+)\]$/,r=/^[0-9]+$/,l=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[-])[A-Za-z\d][A-Za-z\d-]+$/i,c=/^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)$/,m=/^\-?[0-9]+$/,g=/^\-?[0-9]*\.?[0-9]+$/,f=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h=/^[a-z]+$/i,v=/^[a-z0-9]+$/i,y=/^[a-z0-9_\-]+$/i,C=/^[0-9]+$/i,w=/^[1-9][0-9]*$/i,k=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,T=/[^a-zA-Z0-9\/\+=]/i,L=/^[\d\-\s]+$/,S=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;t.prototype.setMessage=function(e,o){return this.messages[e]=o,this},t.prototype.registerCallback=function(e,o){return e&&"string"==typeof e&&o&&"function"==typeof o&&(this.handlers[e]=o),this},t.prototype._formByNameOrNode=function(e){return"object"==typeof e?e:o.forms[e]},t.prototype._addField=function(e,o){this.fields[o]={name:o,display:e.display||o,rules:e.rules,id:null,type:null,value:null,checked:null}},t.prototype._validateForm=function(e){for(var o in this.errors=[],this.fields)if(this.fields.hasOwnProperty(o)){var t=this.fields[o]||{},n=this.form[t.name];n&&n!==u&&(t.id=i(n,"id"),t.type=0<n.length?n[0].type:n.type,t.value=i(n,"value"),t.checked=i(n,"checked"),this._validateField(t))}return"function"==typeof this.callback&&this.callback(this.errors,e),0<this.errors.length&&(e&&e.preventDefault?e.preventDefault():event&&(event.returnValue=!1)),!0},t.prototype._validateField=function(e){for(var o=e.rules.split("|"),t=e.rules.indexOf("required"),n=!e.value||""===e.value||e.value===u,i=0,a=o.length;i<a;i++){var r=o[i],s=null,l=!1,c=d.exec(r);if((-1!==t||-1!==r.indexOf("!callback_")||!n)&&(c&&(r=c[1],s=c[2]),"!"===r.charAt(0)&&(r=r.substring(1,r.length)),"function"==typeof this._hooks[r]?this._hooks[r].apply(this,[e,s])||(l=!0):"callback_"===r.substring(0,9)&&(r=r.substring(9,r.length),"function"==typeof this.handlers[r]&&!1===this.handlers[r].apply(this,[e.value,s])&&(l=!0)),l)){o=this.messages[r+"#"+e.name]||this.messages[r]||p[r],t="An error has occurred with the "+e.display+" field.",o&&(t=o.replace("%s",e.display),s&&((cu=0<=s.indexOf("###")&&s.split("###"))?cu[1]&&(t=cu[1]):t=t.replace("%s",this.fields[s]?this.fields[s].display:s))),this.errors.push({Id:e.id,Name:e.name,Message:t,Rule:r});break}}},t.prototype._hooks={required:function(e){var o=e.value.trim();return"checkbox"===e.type||"radio"===e.type?!0===e.checked:null!==o&&""!==o},default:function(e,o){return e.value!==o},matches:function(e,o){var t=this.form[o];return!!t&&e.value===t.value},valid_ca_zip:function(e){return n.test(e.value)},valid_email:function(e){return f.test(e.value)},valid_emails:function(e){e=e.value.split(",");for(var o=0;o<e.length;o++)if(!f.test(e[o]))return!1;return!0},min_length:function(e,o){return!!r.test(o)&&e.value.length>=parseInt(o,10)},max_length:function(e,o){return!!r.test(o)&&e.value.length<=parseInt(o,10)},exact_length:function(e,o){return!!r.test(o)&&e.value.length===parseInt(o,10)},greater_than:function(e,o){return!!g.test(e.value)&&parseFloat(e.value)>parseFloat(o)},less_than:function(e,o){return!!g.test(e.value)&&parseFloat(e.value)<parseFloat(o)},alpha:function(e){return h.test(e.value)},alpha_numeric:function(e){return v.test(e.value)},alpha_dash:function(e){return y.test(e.value)},alpha_numeric_dash_combo:function(e){return l.test(e.value)},alphanumeric_combo:function(e){return c.test(e.value)},numeric:function(e){return r.test(e.value)},integer:function(e){return m.test(e.value)},decimal:function(e){return g.test(e.value)},is_natural:function(e){return C.test(e.value)},is_natural_no_zero:function(e){return w.test(e.value)},valid_ip:function(e){return k.test(e.value)},valid_phoneno:function(e){return a.test(e.value)},valid_base64:function(e){return T.test(e.value)},valid_url:function(e){return S.test(e.value)},valid_credit_card:function(e){if(!L.test(e.value))return!1;for(var o=0,t=0,n=!1,i=(e=e.value.replace(/\D/g,"")).length-1;0<=i;i--)t=e.charAt(i),t=parseInt(t,10),n&&9<(t*=2)&&(t-=9),o+=t,n=!n;return 0==o%10},is_file_type:function(e,o){if("file"!==e.type)return!0;for(var t=e.value.substr(e.value.lastIndexOf(".")+1),n=o.split(","),i=!1,a=0,r=n.length;a<r;a++)t==n[a]&&(i=!0);return i}},e.FormValidator=t}(window,document);var LRNameSpace={};!function(i){i.Storage=function(n,t){return{isLocalStorageNameSupported:function(e){if(!window[e])return!1;var o=window[e];try{return o.setItem("test","1"),o.removeItem("test"),!0}catch(e){return!1}},setBrowserStorage:function(e,o){var t=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.setItem(e,o),t=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.setItem(e,o),t=!1),t&&n&&n.options&&i.cookies.setItem(e,o,"",n.options.appPath)},getBrowserStorage:function(e){if(t&&e===t.storedTokenName){var o=this.getBrowserStorage("lr-session-token");if(o)return o=o.replace(/"/g,""),this.setBrowserStorage(t.storedTokenName,o),o}return this.isLocalStorageNameSupported("localStorage")&&null!==localStorage.getItem(e)&&void 0!==localStorage.getItem(e)&&""!==localStorage.getItem(e)?localStorage.getItem(e):this.isLocalStorageNameSupported("sessionStorage")&&null!==sessionStorage.getItem(e)&&void 0!==sessionStorage.getItem(e)&&""!==sessionStorage.getItem(e)?sessionStorage.getItem(e):i.cookies.getItem(e)},removeBrowserStorage:function(e){var o=!0;this.isLocalStorageNameSupported("localStorage")&&(localStorage.removeItem(e),o=!1),this.isLocalStorageNameSupported("sessionStorage")&&(sessionStorage.removeItem(e),o=!1),o&&n&&n.options&&i.cookies.removeItem(e,n.options.appPath)}}}}(LRNameSpace),LRNameSpace.cookies={intToString:function(e){return e.toString()},stringToInt:function(e){return parseInt(e,10)||0},isSameSiteNoneCompatible:function(e){return!this.isSameSiteNoneIncompatible(e.toString())},isSameSiteNoneIncompatible:function(e){return this.hasWebKitSameSiteBug(e)||this.dropsUnrecognizedSameSiteCookies(e)},hasWebKitSameSiteBug:function(e){return this.isIosVersion(12,e)||this.isMacosxVersion(10,14,e)&&(this.isSafari(e)||this.isMacEmbeddedBrowser(e))},dropsUnrecognizedSameSiteCookies:function(e){return this.isChromiumBased(e)&&this.isChromiumVersionAtLeast(51,e)&&!this.isChromiumVersionAtLeast(67,e)||this.isUcBrowser(e)&&!this.isUcBrowserVersionAtLeast(12,13,2,e)},regexContains:function(e,o){return null!==e.match(o)},extractRegexMatch:function(e,o,t){var n=e.match(o);return null!==n&&void 0!==n[t]?n[t]:null},isIosVersion:function(e,o){return this.extractRegexMatch(o,/\(iP.+; CPU .*OS (\d+)[_\d]*.*\) AppleWebKit\//,1)===this.intToString(e)},isMacosxVersion:function(e,o,t){var n=/\(Macintosh;.*Mac OS X (\d+)_(\d+)[_\d]*.*\) AppleWebKit\//;return this.extractRegexMatch(t,n,1)===this.intToString(e)&&this.extractRegexMatch(t,n,2)===this.intToString(o)},isSafari:function(e){return null!==e.match(/Version\/.* Safari\//)&&!this.isChromiumBased(e)},isMacEmbeddedBrowser:function(e){return this.regexContains(e,/^Mozilla\/[.\d]+ \(Macintosh;.*Mac OS X [_\d]+\) AppleWebKit\/[.\d]+ \(KHTML, like Gecko\)$/)},isChromiumBased:function(e){return this.regexContains(e,/Chrom(e|ium)/)},isChromiumVersionAtLeast:function(e,o){return e<=this.stringToInt(this.extractRegexMatch(o,/Chrom[^ /]+\/(\d+)[.\d]* /,1))},isUcBrowser:function(e){return this.regexContains(e,/UCBrowser\//)},isUcBrowserVersionAtLeast:function(e,o,t,n){var i=/UCBrowser\/(\d+)\.(\d+)\.(\d+)[.\d]* /,a=this.stringToInt(this.extractRegexMatch(n,i,1)),r=this.stringToInt(this.extractRegexMatch(n,i,2)),s=this.stringToInt(this.extractRegexMatch(n,i,3));return a!==e?e<a:r!==o?o<r:t<=s},getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,t,n,i,a){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var r="",s=function(e){if(e===1/0)return"Fri, 31 Dec 9999 23:59:59 GMT";var o=new Date;return o.setTime(o.getTime()+1e3*e),o.toGMTString()};if(t)switch(t.constructor){case Number:r="; expires="+s(t)+t===1/0?"":"; max-age="+t;break;case String:r="; expires="+t;break;case Date:r="; expires="+t.toUTCString()}var l=navigator.userAgent;return"lr-session-token"===e&&this.isSameSiteNoneCompatible(l)?document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+r+(i?"; domain="+i:"")+(n?"; path="+n:"")+";secure;SameSite=None":document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+r+(i?"; domain="+i:"")+(n?"; path="+n:"")+(a?"; secure":""),!0},removeItem:function(e,o,t){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(t?"; domain="+t:"")+(o?"; path="+o:""),!0)},hasItem:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=e.length,t=0;t<o;t++)e[t]=decodeURIComponent(e[t]);return e}},LRNameSpace.Utilities=function(){var e=navigator.userAgent.toLowerCase(),t={version:(e.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(e),opera:/opera/.test(e),msie:(/msie/.test(e)||/trident/.test(e))&&!/opera/.test(e),mozilla:/mozilla/.test(e)&&!/(compatible|webkit)/.test(e)},i=!1,a=!1,n=[];function r(){if(!a&&(a=!0,n)){for(var e=0;e<n.length;e++)n[e].call(window,[]);n=[]}}function s(){if(!i){var n,e,o;if(i=!0,document.addEventListener&&!t.opera&&document.addEventListener("DOMContentLoaded",r,!1),t.msie&&window===top&&function(){if(!a){try{document.documentElement.doScroll("left")}catch(e){return}r()}}(),t.opera&&document.addEventListener("DOMContentLoaded",function(){if(!a){for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].disabled)return;r()}},!1),t.safari)!function(){if(!a&&("loaded"===document.readyState||"complete"===document.readyState)){if(void 0===n){for(var e=document.getElementsByTagName("link"),o=0;o<e.length;o++)"stylesheet"===e[o].getAttribute("rel")&&n++;var t=document.getElementsByTagName("style");n+=t.length}document.styleSheets.length===n&&r()}}();e=r,o=window.onload,"function"!=typeof window.onload?window.onload=e:window.onload=function(){o&&o(),e()}}}return{browser:t,getHashParam:function(e){var o=window.location.hash.match(new RegExp(e+"=([^&]*)"));return window.location.hash&&null!=o?o[1]:this.getQueryParameterByName(e)},keysToLowerCase:function(e){for(var o,t=Object.keys(e),n=t.length,i={};n--;)i[(o=t[n]).toLowerCase()]=e[o],"object"==typeof i[o.toLowerCase()]&&null!=i[o.toLowerCase()]&&(i[o.toLowerCase()]=this.keysToLowerCase(i[o.toLowerCase()]));return i},elementsByClass:function(e,o){if(""!==e){o=o||document.body;for(var t=[],n=new RegExp("(^| )"+e+"( |$)"),i=o.getElementsByTagName("*"),a=0,r=i.length;a<r;a++)n.test(i[a].className)&&t.push(i[a]);return t}},isValidUrl:function(e){return!!/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i.test(e)},hasClass:function(e,o){return e.className.match(new RegExp("(\\s|^)"+o+"(\\s|$)"))},addclass:function(e,o){return!this.hasClass(e,o)&&(e.className+=" "+o,!0)},isSubstring:function(e,o){for(var t in o)if(-1!==o[t].indexOf(e))return t;return!1},isJsonString:function(e){try{return JSON.parse(e)}catch(e){return!1}},addEvent:function(e,o,t){var n=[];o instanceof Array?n=o:n.push(o);for(var i=0;i<n.length;i++)n[i]["on"+e]=t},getQueryParameterByName:function(e,o){o="&"+(o||location.search),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(o);return null==t?null:decodeURIComponent(t[1].replace(/\+/g," "))},getParameterByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))},getQueryStringValue:function(e,o){var t=e||window.location.href,n=new RegExp("[?&]"+o+"=([^&#]*)","i").exec(t);return n?n[1]:null},extend:function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])},ready:function(e,o){s(),a?e.call(window,[]):n.push(function(){return e.call(window,[])})},parseQueryString:function(e){var o={};if((e||""!==e)&&"string"==typeof e)for(var t=e.split("&"),n=0;n<t.length;n++){var i=t[n].split("=");o[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return o},encodedString:function(e){return-1===e.indexOf("%2B")&&(e=e.replace(/\+/g,"%2B")),e},mergeOptions:function(e,o){var t={};for(var n in e)t[n]=e[n];for(var i in o)t[i]=o[i];return t},mergeObjects:function(e,o,t){var n,i=[];for(var a in e){for(var r in o)n=t?o[r]===e[a]:o[r].name===e[a].name;if(n)break;i.push(e[a])}return i=i.concat(o)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},randomString:function(e){var o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");e=e||Math.floor(Math.random()*o.length);for(var t="",n=0;n<e;n++)t+=o[Math.floor(Math.random()*o.length)];return t},findInSchema:function(e,o,t,n){for(var i=0;i<e.length;i++){if((n?e[i]&&e[i][o].toLowerCase():e[i]&&e[i][o])===t)return e[i]}return null},jsonToQueryString:function(o){return Object.keys(o).map(function(e){return o[e]?encodeURIComponent(e)+"="+encodeURIComponent(o[e]):""}).join("&")},insertBefore:function(e,o){o.parentNode.insertBefore(e,o)},isEmpty:function(e){for(var o in e)if(e.hasOwnProperty(o))return!1;return!0},keyslowerToUpperCamelCase:function(e){for(var o,t=Object.keys(e),n=t.length,i={};n--;)i[(o=t[n]).charAt(0).toUpperCase()+o.substr(1)]=e[o];return i},findElementByRegex:function(e,o,t){var n;n=t?document.querySelectorAll(t):document.querySelectorAll("*");for(var i=[],a=0;a<n.length;a++)o.test(n[a][e])&&i.push(n[a]);return i},isObject:function(e){return e instanceof Object&&e.constructor===Object}}},LRNameSpace.ProgressiveProfiling=function(v,y,C,w){return{fetchSchema:function(e){v.util.ajaxCall("get",w.configApiDomain+"progressiveProfilingSchema?apikey="+v.options.apiKey+"&appName="+v.options.appName,"",e)},execStep:function(u,e){if(v.progressiveProfilingSchema){var p=e.onSuccess||function(){},d=e.onError||function(){},m=e.container||"",g=e.classPrefix||"",f=e.templateName||"",h=v.storage.getBrowserStorage(w.storedTokenName);h&&v.util.ajaxCall("get",w.apiDomain+"/auth/socialidentity?apiKey="+v.options.apiKey+"&access_token="+h,"",function(e){var o=v.util.findInSchema(v.progressiveProfilingSchema.ProfilingSteps,"Step",u);if(o){var t={};t.Profile=e,t.access_token=h;var n=e.Provider.toLowerCase();if("email"===n||"raas"===n||v.options.progressiveProfilingTraditional){v.options.progressiveProfilingTraditional&&"email"!==n&&"raas"!==n&&(e=v.LoggedinSocialProvderProfile);var i=o.Schema,a=y.mapSchema(i,e,null,!0);t.Profile=e,0<a.length?y.createForm(a,"progressiveProfiling",m,function(e){C.updateData(t,m,e,p,d,g,a,"progressiveProfiling")},function(e){d(e)},g):y.loginHandleToken(t,"",p,d)}else{var r=o.Scopes,s=v.util.findInSchema(r,"Provider",n,!0);if(s){var l="https://"+(v.options.customDomain||v.options.appName+"."+w.hubDomain)+"/RequestHandlor.aspx?apikey="+v.options.apiKey+"&provider="+n+"&scope="+s.Scopes,c=[];c.push({Name:n,Endpoint:l}),y.renderCustomInterface(m,"",f,"","",c),y.socialLogin(m,p,d)}else y.loginHandleToken(t,"",p,d)}}else v.log("Step Schema not found.")})}}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var o=this.length>>>0,t=Number(arguments[1])||0;for((t=t<0?Math.ceil(t):Math.floor(t))<0&&(t+=o);t<o;t++)if(t in this&&this[t]===e)return t;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(null==this)throw new TypeError;var o=Object(this),t=o.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=[],i=arguments[1],a=0;a<t;a++)if(a in o){var r=o[a];e.call(i,r,a,o)&&n.push(r)}return n}),function(i){"use strict";var e={get:function(e){var o=n();return e?o[e]:o},add:function(e){var o=n();for(var t in e)o[t]=e[t];a(o)},remove:function(e){e="string"==typeof e?[e]:e;for(var o=n(),t=0;t<e.length;t++)delete o[e[t]];a(o)},clear:function(){a({})}};function n(){for(var e=i.location.hash?i.location.hash.substr(1).split("&"):[],o={},t=0;t<e.length;t++){var n=e[t].split("=");o[n[0]]=decodeURIComponent(n[1])}return o}function a(e){var o=[];for(var t in e)o.push(t+"="+encodeURIComponent(e[t]));i.location.hash=o.join("&")}i.hash=e}(window),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},writable:!0,configurable:!0});var LoginRadiusDefaults={idPrefix:"loginradius-",classPrefix:"loginradius-",apiDomain:"https://api.loginradius.com/identity/v2",hubDomain:"hub.loginradius.com",cloudApiDomain:"https://cloud-api.loginradius.com/",configApiDomain:"https://config.lrcontent.com/ciam/",socialApiDomain:"https://api.loginradius.com/api/v2/",isRegFormSchemaLock:!1,isSecurityFormSchemaLock:!1,innerHTML:!1,autoFilledFieldforPasswordLesLogin:!1,socialRegFormId:"",lrResponseCounter:0,LRPhoneNo:"",lrCounterJwtResponse:"",lrCounterTokenResponse:"",storedTokenName:"LRTokenKey",storedTwoFAToken:"lr2fatok",storedSessionTokenData:"lrSessionTokenObj",storedOTPAuth:"lrotpauthver",storedGAAuth:"lrgaauthver",storedUidName:"lr-user-uid",tokenCookie:"lr-user--token",isSSOInitFired:!1,pingCount:1,messages:{tokenValid:{Message:"Access token is not valid",Description:"LoginRadius Access Token is invalid, please verify the authentication response",ErrorCode:905},twofaTokenValid:{Message:"Token is not valid",Description:"Your session is not valid."},invalidEmail:{Message:"Invalid Email",Description:"The email entered is not a valid email."},invalidPhone:{Message:"Invalid Phone",Description:"The mobile number entered is not valid."},disabledAccountLinking:"Account Linking disabled in your account",noSecurityQuestions:"There are no security questions for this application",invalidSott:"Something went wrong, please try again.",notValidMessage:"Error Message element not valid",passwordStrengthMessage:"Password strength meter configuration is not valid.",otpSent:"OTP Sent Successfully",vTokenError:{Message:"Verification token not found in query string."},notFound:"Data not found.",emailNotVerified:{Message:"The email is not verified, please verify the link in your email",Description:"The email is not verified, please verify the link in your email",ErrorCode:970},phoneNotVerified:{Message:"Phone number is not verified",Description:"The provided phone number is not verified, please use a verified phone number for login.",ErrorCode:1066},blockedUser:{Message:"User is blocked",Description:"This user is blocked by site admin",ErrorCode:991},unverifiedUser:{Message:"This Uid have only traditional unverified account",Description:"This Uid have only traditional unverified account",ErrorCode:1028}},buttonNames:{login:"Login",socialregistration:"Login",loginrequiredfieldsupdate:"Login",registration:"Register",verifyemail:"Verify",resetpassword:"Reset Password",resetpin:"Reset PIN",sociallogin:"Login",otp:"Verify",twofaotp:"Verify",showqrcode:"Verify",updatephone:"Update",changephone:"Update",forgotpassword:"Send",forgotpin:"Send",securityquestions:"Get",changepassword:"Submit",changepin:"Change PIN",resendemailverification:"Send",addemail:"Send",removeemail:"Send",changeusername:"Submit",profileeditor:"Update Profile",otplogin:"OTP",passwordlessloginbuttonlabel:"Email me a link to Sign In",passwordlessloginotpbuttonlabel:"Send an OTP to Sign In",createtwofactorauthentication:"2-Step Verification",sendotp:"Send OTP",resendotp:"Resend OTP",changenumber:"Change Number",backupcode:"Login",backupcodebutton:"Try another way to Sign In",backupcodebackbutton:"Back",disablegoogleauthenticator:"Disable Google Authenticator",disableotpauthenticator:"Disable OTP Authenticator",updatesecurityquestion:"Update Security Question",resetpwdbysecq:"Reset Password By SecurityQ",resetpinbysecq:"Reset PIN By SecurityQ",smartlogin:"Smart Login",validatecode:"Validate",onetouchlogin:"Login",progressiveprofiling:"Progressive Profiling",privacypolicyupdate:"Accept",updatephone2fa:"Update",pinsetup:"Set Pin",pinlogin:"Login",pinreauthentication:"Verify",pinloginbackbtn:"Back",consentlogin:"Submit Consent",customeventconsent:"Submit Consent",consenteditor:"Submit Consent"},templates:{consentMainTemplate:"loginradius_consent_custom_tmpl",consentGroupTemplate:"loginradius_consent_group_tmpl",consentOptionTemplate:"loginradius_consent_option_tmpl"},options:{passwordlessLoginEmailTemplate:"",callbackUrl:window.location,callbackInsideSameWindow:"",callbackType:"",scope:"",loginUrl:"",deleteUrl:"",emailTemplate:"",verificationUrl:"",verificationEmailTemplate:"",resetPasswordEmailTemplate:"",resetPINEmailTemplate:"",resetPasswordConfirmationEmailTemplate:"",resetPINConfirmationEmailTemplate:"",smartLoginRedirectUrl:"",autoLoginRedirectUrl:"",smartLoginEmailTemplate:"",autoLoginEmailTemplate:"",smsTemplate2FA:"",smsTemplateForgot:"",smsTemplateWelcome:"",smsTemplateOneTouchLoginWelcome:"",smsTemplateOneTouchLogin:"",passwordlessLoginSMSTemplate:"",smsTemplate2FAWelcome:"",smsTemplatePhoneVerification:"",smsTemplateUpdatePhone:"",welcomeEmailTemplate:"",onetouchLoginEmailTemplate:"",onetouchLoginRedirectUrl:"",resetPasswordUrl:"",resetPINUrl:"",templateName:"",debugMode:!1,tokenType:"lrtoken",integrationName:"",smartLoginPingCount:100,smartLoginPingInterval:5,maskSensitiveInput:!1,enableHeaderSott:!0,accessTokenResponse:!0,rbaOneclickEmailTemplate:"",rbaOTPSmsTemplate:"",rbaCityEmailTemplate:"",rbaCountryEmailTemplate:"",rbaBrowserEmailTemplate:"",rbaIpEmailTemplate:"",rbaCitySmsTemplate:"",rbaCountrySmsTemplate:"",rbaBrowserSmsTemplate:"",rbaIpSmsTemplate:"",setLRSession:!1,askOptionalFieldsOnProgressiveSteps:!0},regexExpression:{emailRegex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,phoneRegex:/^(\\+)|(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{8,14}$/},_uuidFormat:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i};function LoginRadiusUtility(v,y){var p=LoginRadiusDefaults.buttonNames,C=new LRNameSpace.Utilities,d=this;d.elementById=function(e,o){var t=document.getElementById(e);if(t)return t;o||v.log("Unable to find id: "+e)},d.getThisObjectName=function(){for(var e in v.global)if("frameElement"!==e&&"webkitStorageInfo"!==e&&"webkitIndexedDB"!==e&&v.global[e]===v)return e},d.serialize=function(e){if(e&&"FORM"===e.nodeName){var o,t,n=[];for(o=e.elements.length-1;0<=o;--o)if(""!==e.elements[o].name&&""!==e.elements[o].value.trim())switch("emailid"!==e.elements[o].name||v.options.usernameLogin||v.options.duplicateEmailWithUniqueUsername||(e.elements[o].value=e.elements[o].value.toLowerCase()),e.elements[o].nodeName){case"INPUT":switch(e.elements[o].type){case"text":case"hidden":case"button":case"reset":case"submit":case"email":var i=e.elements[o].name;"emailid"===i&&(i="email"),e.elements[o].disabled||n.push(i+"="+encodeURIComponent(e.elements[o].value.trim()));break;case"password":n.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value));break;case"checkbox":n.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].checked));break;case"radio":e.elements[o].checked&&n.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value))}break;case"TEXTAREA":n.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value.trim()));break;case"SELECT":switch(e.elements[o].type){case"select-one":n.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value.trim()));break;case"select-multiple":for(t=e.elements[o].options.length-1;0<=t;--t)e.elements[o].options[t].selected&&n.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].options[t].value.trim()))}break;case"BUTTON":switch(e.elements[o].type){case"reset":case"submit":case"button":n.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value.trim()))}}return n.join("&")}},d.addJs=function(e,o){var t=(o=o||document).getElementsByTagName("head")[0],n=o.createElement("script");return n.src=e,n.type="text/javascript",t.appendChild(n),n},d.hashTmpl=function e(o,t){var n=/\W/.test(o)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+o.replace(/[\r\t\n]/g," ").split("<#").join("\t").replace(/((^|#>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)#>/g,"',$1,'").split("\t").join("');").split("#>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[o]=i[o]||(d.elementById(o)?e(d.elementById(o).innerHTML):"");return"function"==typeof n?t?n(t):n:""};var i={};d.tmpl=function e(o,t){var n=/\W/.test(o)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+o.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[o]=i[o]||(d.elementById(o)?e(d.elementById(o).innerHTML):"");return"function"==typeof n?t?n(t):n:""},d.jsonpCall=function(e,o,t,n){v.$hooks.call("startProcess",n);var i=t||"Loginradius"+Math.floor(1e18*Math.random()+1);window[i]=function(e){o(e),v.$hooks.call("endProcess",n)};var a=-1!==e.indexOf("?")?e+"&callback="+i:e+"?callback="+i;d.addJs(a)},d.getButtonAttribute=function(e,o){var t,n=o||LoginRadiusDefaults.idPrefix;return v.buttonElements[e]?t=(t=v.buttonElements[e]).cloneNode(!0):((t=document.createElement("input")).type="button",t.value=v.buttonsName[e]||p[e]),t.id=n+"button-"+e,t},d.ajaxCall=function(e,o,i,a,r,s){var l=this,c=r;if(r&&-1!==r.indexOf("##")&&(c=r.split("##")[1]),LoginRadiusDefaults._uuidFormat.test(y.apiKey)){v.$hooks.call("startProcess",r,i);try{var u=new XMLHttpRequest;if(v.options.projectionFields&&r){var t=Object.keys(v.options.projectionFields),n=["verifyOTP","updateData"],p=!1,d=r;if(v.LRCheckRegistration?(p=-1!==n.indexOf(r),d="registration"):v.LRCheckLogin&&(p=-1!==n.indexOf(r),d="login"),-1!==t.indexOf(r)||p){var m=v.options.projectionFields[d];if(m&&0<m.length){var g=["ErrorCode","Profile/Uid","Profile/IsDeleted","access_token","Profile/EmailVerified","Profile/PhoneIdVerified","Profile/PhoneId","PhoneId","PhoneIdVerified","EmailVerified","Uid","IsDeleted"];(v.options.twoFactorAuthentication||v.options.optionalTwoFactorAuthentication)&&g.push("SecondFactorAuthentication/SecondFactorAuthenticationToken","SecondFactorAuthentication/IsOTPAuthenticatorVerified","SecondFactorAuthentication/IsGoogleAuthenticatorVerified","SecondFactorAuthentication/OTPPhoneNo","SecondFactorAuthentication/ManualEntryCode"),m=C.mergeObjects(m,g,!0);for(var f="&fields=",h=0;h<m.length;h++)h===m.length-1?f+=m[h]:f=f+m[h]+",";o+=f}}}u.open(e,o,!0),(-1<o.indexOf("/ssologin/")||"setToken"===r)&&(u.withCredentials=!0),-1===o.indexOf("cdn")&&-1===o.indexOf(".json")&&u.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.sottcheck&&(u.setRequestHeader("X-LoginRadius-Sott",v.options.sott),delete i.sottcheck),i?(i="string"==typeof i||i instanceof String?JSON.stringify(C.parseQueryString(i)):JSON.stringify(i),u.setRequestHeader("Content-Type","application/json"),u.send(i)):u.send(null),u.onreadystatechange=function(){if(4===u.readyState){var e,o=u.response;if(o){var t=JSON.parse(o);-1<Object.keys(t).map(function(e){return e.toLowerCase()}).indexOf("errorcode")?v.$hooks.call("xhrEndWithError",r):v.$hooks.call("xhrEndWithSuccess",r)}if("500"==u.status){var n=JSON.parse(o);n.ErrorCode="500",o=JSON.stringify(n),v.$hooks.call("xhrEndWithError",r)}(e=l.isJsonString(o))&&(v.$hooks.call("successCallback",c,e,i),s?a(s,e):a(e)),v.$hooks.call("endProcess",r)}},u.onerror=function(){v.$hooks.call("xhrEndWithError",r)}}catch(e){}}else v.log("apiKey is not in valid guid format.")},d.openWindow=function(e){if(e=e||d.href,!v.options.isMobile){var o=document.createElement("a");o.href=e;var t=C.getQueryParameterByName("provider",o.search),n="";v.options.noCallbackForSocialLogin&&(e+="&nocallback=true&callbackguid="+(n=v.util.randomString(16)));var i=v.options.customizeSocialPopup||"menubar=1,resizable=1,width=450,height=450,scrollbars=1";return window.open(e,"lrpopupchildwindow",i),v.$hooks.call("socialCalls",t,n),!1}var a="no";v.options.debugMode&&(a="yes");var r=window.open(e,"_blank","location="+a);r.addEventListener("loadstop",function(e){var o,t=null===(o=new RegExp("[\\?&]"+"token"+"=([^&#]*)").exec(e.url))?"":decodeURIComponent(o[1].replace(/\+/g," "));null!=t&&""!==t&&(r.close(),html5passToken(t))})},d.addHTMLContent=function(e,o,t,n,i){t=t||!1;var a=d.elementById(e);if(a||n)if(t||(a.innerHTML=""),n){var r=p[n.toLowerCase()],s=i||LoginRadiusDefaults.idPrefix,l=d.elementById(s+"submit-"+r.toLowerCase().replace(/ /g,"-"));C.insertBefore(o,l)}else a.appendChild(o);else{var c=C.elementsByClass(e);if(c&&0<c.length)for(var u=0;u<c.length;u++)t||(c[u].innerHTML=""),c[u].appendChild(o)}},d.addRecaptchaJS=function(e){window.grecaptcha||!v.options.v2Recaptcha&&!e?!window.grecaptcha&&v.options.invisibleRecaptcha&&d.addJs("https://www.google.com/recaptcha/api.js"):v.options.v2RecaptchaLanguage?d.addJs("https://www.google.com/recaptcha/api.js?render=explicit&hl="+v.options.v2RecaptchaLanguage):d.addJs("https://www.google.com/recaptcha/api.js?render=explicit"),(v.options.tencentCaptcha||v.options.tencentCaptchaAsFallback)&&d.addJs("https://ssl.captcha.qq.com/TCaptcha.js")},d.renderV2Recaptcha=function(t,e,n){var i,a=d.elementById(t);if(v.options.v2Recaptcha||e||v.options.invisibleRecaptcha||v.options.tencentCaptcha||v.options.tencentCaptchaAsFallback){window.grecaptcha&&a&&a.innerHTML&&grecaptcha.reset(window[t+"lr_recaptcha_widgets_idprefix"]);var o=setInterval(function(){i||(i=setInterval(function(){if(window.grecaptcha){if(a&&""===a.innerHTML){var e={sitekey:v.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3",theme:"light",callback:function(e){a.style.display="block",n&&n(e)}};v.options.invisibleRecaptcha&&(e.size="invisible",e.callback="onCaptchaSubmit"),window[t+"lr_recaptcha_widgets_idprefix"]=grecaptcha.render(t,e),clearInterval(i)}}else{t+="_tencent";var o=document.getElementById(t);o&&(o.style.display="block"),"undefined"!=typeof TencentCaptcha&&new TencentCaptcha(document.getElementById(t)),clearInterval(i)}},1e3),clearInterval(o))},1e3)}},d.captchaSchema=function(e,o,t,n){if(!v.options.v2Recaptcha&&!t||d.elementById(e)){if(v.options.invisibleRecaptcha&&!d.elementById(e)){var i="";"hide"===t&&(i="display:none");var a={type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" style="'+i+'" class="g-recaptcha" data-sitekey="'+(v.options.v2RecaptchaSiteKey||"6LeAiwITAAAAADlqb06JIGepBs8ZRo3OZ7C0W7U3")+'" data-size="invisible" data-callback="onCaptchaSubmit"></div>',display:"Captcha",rules:""};o.push(a)}}else{var r={type:"captcha",name:"g-recaptcha-response",html:'<div id="'+e+'" class="recaptcha_widget"></div>',display:"Captcha",rules:"required"};o.push(r)}if(!d.elementById(e)&&(v.options.tencentCaptcha||v.options.tencentCaptchaAsFallback)){window.onTencentCaptchaSubmit=function(e){0==e.ret&&(n?n(e):window.onTencentCaptchaSubmitCallback(e))};var s={type:"captcha",name:"TencentCaptcha",html:"<div "+(t?"style=display:none; ":"")+' id= "'+e+'_tencent"  class="TencentCaptcha"  data-appid="'+v.options.tencentCaptchaAppid+'" data-cbfn="onTencentCaptchaSubmit"></div>',display:"Captcha",rules:""};o.push(s)}},d.checkPhoneOrEmailLogin=function(e){var o=C.parseQueryString(e);if(o.emailid||o.email)if(v.options.duplicateEmailWithUniqueUsername&&!o.username)e=e.replace("emailid","username").replace("email","username");else{var t=o.emailid||o.email;LoginRadiusDefaults.regexExpression.emailRegex.test(t)?e=e.replace("emailid","email"):v.options.phoneLogin&&LoginRadiusDefaults.regexExpression.phoneRegex.test(t)?(e=e.replace("emailid","phone").replace("email","phone"),e+="&phoneApi=1"):v.options.usernameLogin&&(e=e.replace("emailid","username").replace("email","username"))}return e}}function LoginRadiusApiFramework(u,p){var e=this;e.init=function(){u.lrApiFramework=!0},e.login=function(e,o,t){u.getAppConfiguration(function(){p.loginController(u.util.jsonToQueryString(e),null,o,t)})},e.otpLogin=function(e,o,t){u.getAppConfiguration(function(){p.loginOTPController(u.util.jsonToQueryString(e),null,o,t)})},e.twoFALogin=function(e,o,t,n,i,a,r,s){n=n||function(){},r=r||function(){},s=s||function(){},i=i||function(){},a=a||function(){};u.getAppConfiguration(function(){p.login2FAController(u.util.jsonToQueryString(e),null,o,t,"",r,s,n,i,a)})},e.registration=function(e,o,t,n,i,a){i=i||function(){},a=a||function(){};u.getAppConfiguration(function(){p.registrationController(o,null,t,n,"",e,i,a)})},e.forgotPassword=function(e,o,t){u.getAppConfiguration(function(){p.forgotPasswordController(u.util.jsonToQueryString(e),"",o,t)})},e.forgotPIN=function(e,o,t){u.getAppConfiguration(function(){p.forgotPINController(u.util.jsonToQueryString(e),"",o,t)})},e.resetPassword=function(e,o,t){u.getAppConfiguration(function(){p.resetPasswordController(u.util.jsonToQueryString(e),o,t)})},e.resetPIN=function(e,o,t){u.getAppConfiguration(function(){p.resetPINController(u.util.jsonToQueryString(e),o,t)})},e.emailVerification=function(e,o,t){u.getAppConfiguration(function(){p.emailVerificationController(e.vtoken,o,t)})},e.socialLogin=function(e,o,t,n,i,a){u.getAppConfiguration(function(){u.LoginRadiusHostedPage&&u.SSOinitFired||(n=n||function(){},i=i||function(){},p.socialLoginReceiveToken(e.token,a,o,t,null,n,i))})},e.resendEmailVerification=function(e,o,t){u.getAppConfiguration(function(){p.resendEmailVerificationController(u.util.jsonToQueryString(e),o,t)})},e.twoFAResendOTP=function(e,o,t){u.getAppConfiguration(function(){p.resendOTP2FAController(u.util.jsonToQueryString(e),o,t)})},e.twoFAVerifyOTP=function(e,o,t){u.getAppConfiguration(function(){p.verify2FAOTPController(u.util.jsonToQueryString(e),o,t)})},e.twoFAUpdatePhone=function(e,o,t,n,i,a,r){n=n||function(){},i=i||function(){},a=a||function(){},r=r||function(){};u.getAppConfiguration(function(){p.update2FAPhoneNumberController(e,null,o,t,null,n,i,a,r)})},e.updatePhone=function(e,o,t,n,i,a,r){a=a||function(){},r=r||function(){},n=n||function(){},i=i||function(){};u.getAppConfiguration(function(){p.updatePhoneNumberController(u.util.jsonToQueryString(e),null,o,t,null,a,r,n,i)})},e.verifyOTP=function(e,o,t,n){u.getAppConfiguration(function(){p.verifyOTPController(e,o,t,n)})},e.resendOTP=function(e,o,t){u.getAppConfiguration(function(){p.resendOTPController(u.util.jsonToQueryString(e),o,t)})},e.addEmail=function(e,o,t){u.getAppConfiguration(function(){p.addEmailController(u.util.jsonToQueryString(e),o,t)})},e.removeEmail=function(e,o,t){u.getAppConfiguration(function(){p.removeEmailController(u.util.jsonToQueryString(e),o,t)})},e.changeUsername=function(e,o,t){u.getAppConfiguration(function(){p.changeUsernameController(u.util.jsonToQueryString(e),o,t)})},e.changePassword=function(e,o,t){u.getAppConfiguration(function(){p.changePasswordController(u.util.jsonToQueryString(e),o,t)})},e.changePIN=function(e,o,t){u.getAppConfiguration(function(){p.changePINController(u.util.jsonToQueryString(e),o,t)})},e.checkPhoneNumberAvailability=function(e,o,t){u.getAppConfiguration(function(){p.checkPhoneNumberAvailabilityController(u.util.jsonToQueryString(e),o,t)})},e.resetPasswordByPhone=function(e,o,t){u.getAppConfiguration(function(){p.resetPasswordByPhoneController(u.util.jsonToQueryString(e),o,t)})},e.resetPINByPhone=function(e,o,t){u.getAppConfiguration(function(){p.resetPINByPhoneController(u.util.jsonToQueryString(e),o,t)})},e.forgotPasswordbyPhone=function(e,o,t){u.getAppConfiguration(function(){p.forgotPasswordbyPhoneController(u.util.jsonToQueryString(e),null,o,t)})},e.forgotPINbyPhone=function(e,o,t){u.getAppConfiguration(function(){p.forgotPINbyPhoneController(u.util.jsonToQueryString(e),null,o,t)})},e.updateData=function(e,o,t,n,i,a){var r=n,s=i,l={};"object"==typeof n&&(l=n,r=i,s=a);var c={};c.Profile=l,c.access_token=t;u.getAppConfiguration(function(){p.updateData(c,null,o,r,s,"",e)})},e.checkEmailAvailability=function(e,o,t){u.getAppConfiguration(function(){p.checkEmailAvailabilityController(u.util.jsonToQueryString(e),o,t)})},e.checkUserNameAvailability=function(e,o,t){u.getAppConfiguration(function(){p.checkUserNameAvailabilityController(u.util.jsonToQueryString(e),o,t)})},e.resetPasswordBySecurityQuestion=function(e,o,t){u.getAppConfiguration(function(){p.resetPasswordBySecurityQuestionController(u.util.jsonToQueryString(e),o,t)})},e.resetPINBySecurityQuestion=function(e,o,t){u.getAppConfiguration(function(){p.resetPINBySecurityQuestionController(u.util.jsonToQueryString(e),o,t)})},e.updateSecurityQuestion=function(e,o,t){u.getAppConfiguration(function(){p.updateSecurityQuestionController(u.util.jsonToQueryString(e),o,t)})},e.resetTwoFactor=function(e,o,t){u.getAppConfiguration(function(){p.resetTwoFactorAuthenticationController(e,o,t)})},e.invalidateToken=function(e,o,t){u.getAppConfiguration(function(){p.invalidateToken(e,o,t)})},e.validateToken=function(e,o,t){u.getAppConfiguration(function(){p.validateToken(e,o,t)})},e.getSocialData=function(e,o,t,n,i){u.getAppConfiguration(function(){p.getSocialDataController(e,o,t,n,i)})},e.postSocialData=function(e,o,t,n,i,a){u.getAppConfiguration(function(){p.postSocialDataController(e,o,t,n,i,a)})},e.getCustomObjects=function(e,o,t){u.getAppConfiguration(function(){p.getCustomObjectsController(e,o,t)})},e.createCustomObject=function(e,o,t,n){u.getAppConfiguration(function(){p.createCustomObjectController(e,o,t,n)})},e.getCustomObjectById=function(e,o,t,n){u.getAppConfiguration(function(){p.getCustomObjectByIdController(e,o,t,n)})},e.deleteCustomObjectById=function(e,o,t,n){u.getAppConfiguration(function(){p.deleteCustomObjectController(e,o,t,n)})},e.updateCustomObjectById=function(e,o,t,n,i,a){u.getAppConfiguration(function(){p.updateCustomObjectController(e,o,t,a,n,i)})},e.getBackupCode=function(e,o,t){u.getAppConfiguration(function(){p.getBackupCodeController(e,o,t)})},e.resetBackupCode=function(e,o,t){u.getAppConfiguration(function(){p.resetBackupCodeController(e,o,t)})},e.autoLogin=e.smartLogin=function(e,o,t){u.getAppConfiguration(function(){p.smartLoginController(u.util.jsonToQueryString(e),o,t)})},e.verifyConsent=function(e,o,t){u.getAppConfiguration(function(){p.verifyConsentController(e,o,t)})},e.fetchConsentLogs=function(e,o){u.getAppConfiguration(function(){p.consentLogsController(e,o)})},e.updateConsents=function(e,o,t){u.getAppConfiguration(function(){p.updateConsentController(e,o,t)})},e.submitConsentbyConsentToken=function(e,o,t){var n=e.consentToken?e.consentToken:"";if(n){u.getAppConfiguration(function(){p.submitConsentController(n,e,o,t)})}else t({response:"consentToken is required parameter"}),u.log("consentToken is required parameter")},e.submitConsentbyAccesToken=function(e,o,t){u.getAppConfiguration(function(){p.customEventConsentController(e,o,t)})}}function setLoginRadiusDefaultSchema(e){e.loginFormSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.backupCodeFormSchema=[{type:"string",name:"backupcode",display:"Backup Code",rules:"required",permission:"r"}],e.resetPasswordByPhoneSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"},{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"}],e.resetPINByPhoneSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"},{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"}],e.checkPhoneNumberSchema=[{type:"string",name:"phone",display:"Phone Number",rules:"required|valid_phoneno",permission:"r"}],e.QRCodeSchema=[{type:"string",name:"googleAuthenticatorCode",display:"Google Authenticator Code",rules:"required",permission:"r"}],e.getSecQSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required|valid_email",permission:"r"}],e.otpSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"}],e.forgotPasswordFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.forgotPINFormSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"}],e.smartLoginSchema=[{type:"string",name:"emailid",display:"Email Id",rules:"required",permission:"r"}],e.passwordLessLoginSchema=[{type:"string",name:"emailid",display:"Email",rules:"required",permission:"r"},{type:"string",name:"name",display:"Name",rules:"",permission:"r"}],e.changePasswordFormSchema=[{type:"password",name:"oldpassword",display:"Old Password",rules:"required",permission:"w"},{type:"password",name:"newpassword",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmnewpassword",display:"Confirm Password",rules:"required|min_length[6]|max_length[32]|matches[newpassword]",permission:"w"}],e.emailSchema=e.forgotPasswordFormSchema,e.addEmailSchema=[{type:"string",name:"emailid",display:"Email",rules:"required|valid_email",permission:"r"},{type:"string",name:"type",display:"Type",rules:"required",permission:"r"}],e.changeUsernameFormSchema=[{type:"string",name:"username",display:"Username",rules:"required",permission:"r"}],e.changePINFormSchema=[{type:"password",name:"oldpin",display:"Old PIN",rules:"required",permission:"w"},{type:"password",name:"newpin",display:"PIN",rules:"required",permission:"w"},{type:"password",name:"confirmnewpin",display:"Confirm PIN",rules:"required|matches[newpin]",permission:"w"}],e.resetPasswordFormSchema=[{type:"password",name:"password",display:"Password",rules:"required|min_length[6]|max_length[32]",permission:"w"},{type:"password",name:"confirmpassword",display:"Confirm Password",rules:"required|matches[password]|min_length[6]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.resetPINFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required|min_length[4]|max_length[32]",permission:"w"},{type:"password",name:"confirmpin",display:"Confirm PIN",rules:"required|matches[pin]|min_length[4]|max_length[32]",permission:"w"},{type:"hidden",name:"resettoken",display:"",rules:"required",permission:"w",value:""}],e.pinLoginFormSchema=[{type:"password",name:"pin",display:"PIN",rules:"required",permission:"r"}],e.privacyPolicySchema=[{type:"multi",name:"acceptprivacypolicy",display:"I agree to the terms of service",rules:"",permission:"r"}],e.btnOTPSchema={type:"button",name:"click",display:"click",rules:"",permission:"r",event:"click",eventCallback:function(){}},e.defaultBtnSchema={type:"button",name:"default",display:"default",rules:"",permission:"r",event:"click",eventCallback:function(){}}}function setLoginRadiusModuleFunctions(u,p){var t=LoginRadiusDefaults.options,d=new SetLoginRadiusCommonFunctions(u),e=new LoginRadiusControllers(u,d),m=u.util;u.version="3.10.5",u.LRCheckRegistration=!1,u.passwordlessLoginFlag=!1,u.socialLoginFlag=!1,u.LRCheckLogin=!1,u.LRCheck2FA=!1,u.loginAction=!1,u.options="",u.consentOptions="",u.sessionData={getUid:function(){return u.storage.getBrowserStorage(LoginRadiusDefaults.storedUidName)},getToken:function(){return u.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)}},u.errorMessages=[],u.validationMessages=[],u.formCustomLabel={},u.formElementsTitle={},u.defaultOptionField={},u.formValidations={},u.formPlaceholder={},u.formElementAttributes={},u.buttonElements={},u.passwordMeterConfiguration=[],u.buttonsName={},u.eventsName={},u.log=function(e){u.options.debugMode&&"undefined"!=typeof console&&console.error(e)},u.customInterface=function(e,o){var t=o.templateName||"";i(function(){d.renderCustomInterface(e,"",t)})},u.clearSession=function(){u.storage.removeBrowserStorage(LoginRadiusDefaults.storedTokenName),u.storage.removeBrowserStorage(LoginRadiusDefaults.storedUidName),u.storage.removeBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),u.removeSessionToken()},u.setSessionToken=function(e){var o={session_token:e.session_token,session_expires_in:e.session_expires_in};u.storage.setBrowserStorage(LoginRadiusDefaults.storedSessionTokenData,JSON.stringify(o))},u.getSessionToken=function(){var e=JSON.parse(u.storage.getBrowserStorage(LoginRadiusDefaults.storedSessionTokenData));return e&&e.session_expires_in&&new Date<new Date(e.session_expires_in)?e.session_token:(u.removeSessionToken(),!1)},u.removeSessionToken=function(){u.storage.removeBrowserStorage(LoginRadiusDefaults.storedSessionTokenData)},u.documentCookies=Object.assign({},LRNameSpace.cookies);var n=[];function i(e){u.isApiCallingStarted||""!==u.options?u.isApiCallingStarted&&(""!==u.options?e():"logout"===u.useraction?(u.isApiCallingStarted=!1,i(e)):n.push(e)):(u.isApiCallingStarted=!0,n.push(e),m.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"appInfo?apikey="+p.apiKey,"",function(e){!function(e){var o={};if(p.securityQuestionEnabled=e.IsSecurityQuestion,p.appName=p.appName||e.AppName,p.RegistrationFormSchema=e.RegistrationFormSchema,p.loginLockedType=e.LoginLockedConfiguration&&e.LoginLockedConfiguration.LoginLockedType,p.securityQuestionEnabled&&(p.SecurityQuestions=e.SecurityQuestions.Questions,p.securityQuestionsCount=void 0===p.securityQuestionsCount?e.SecurityQuestions.SecurityQuestionCount:p.securityQuestionsCount),void 0===p.passwordLength&&p.displayPasswordStrength&&p.RegistrationFormSchema){var t=m.findInSchema(p.RegistrationFormSchema,"name","password").rules.split("|"),n=m.isSubstring("min_length[",Object.keys(t).map(function(e){return t[e]})),i=t[n].substring(t[n].lastIndexOf("min_length[")+11,t[n].lastIndexOf("]")),a=m.isSubstring("max_length[",Object.keys(t).map(function(e){return t[e]})),r=t[a].substring(t[a].lastIndexOf("max_length[")+11,t[a].lastIndexOf("]")),s={min:parseInt(i),max:parseInt(r)};p.passwordLength=s}if(p.SocialSchema=e.SocialSchema,p.maskSensitiveInput=p.encryptedAnswer||p.maskSensitiveInput,p.noCallbackForSocialLogin=void 0!==p.noCallback?p.noCallback:p.noCallbackForSocialLogin,p.v2RecaptchaSiteKey=p.v2RecaptchaSiteKey||e.V2RecaptchaSiteKey,e.TwoFactorAuthentication.IsEnabled&&(o.optionalTwoFactorAuthentication=!0,o.twoFactorAuthentication=!1,o.googleAuthentication=e.TwoFactorAuthentication.IsGoogleAuthenticator,e.TwoFactorAuthentication.IsRequired&&(o.optionalTwoFactorAuthentication=!1,o.twoFactorAuthentication=!0)),p.otpEmailVerification=void 0===p.otpEmailVerification?e.OTPEmailVerification:p.otpEmailVerification,p.optionalTwoFactorAuthentication=void 0===p.optionalTwoFactorAuthentication?o.optionalTwoFactorAuthentication:p.optionalTwoFactorAuthentication,p.twoFactorAuthentication=void 0===p.twoFactorAuthentication?o.twoFactorAuthentication:p.twoFactorAuthentication,p.googleAuthentication=void 0===p.googleAuthentication?o.googleAuthentication:p.googleAuthentication,p.phoneLogin=void 0===p.phoneLogin?e.IsPhoneLogin:p.phoneLogin,p.passwordlessLoginOTP=void 0===p.instantOTPLogin&&void 0===p.passwordlessLoginOTP?e.IsInstantSignin.SmsOtp:p.instantOTPLogin||p.passwordlessLoginOTP,"optional"===e.EmailVerificationFlow?o.optionalEmailVerification=!0:"disabled"===e.EmailVerificationFlow&&(o.disabledEmailVerification=!0),p.optionalEmailVerification=void 0===p.optionalEmailVerification?o.optionalEmailVerification:p.optionalEmailVerification,p.disabledEmailVerification=void 0===p.disabledEmailVerification?o.disabledEmailVerification:p.disabledEmailVerification,p.loginOnEmailVerification=void 0===p.loginOnEmailVerification?e.IsLoginOnEmailVerification:p.loginOnEmailVerification,p.passwordlessLogin=void 0===p.instantLinkLogin&&void 0===p.passwordlessLogin?e.IsInstantSignin.EmailLink:p.instantLinkLogin||p.passwordlessLogin,p.askRequiredFieldForTraditionalLogin=void 0===p.askRequiredFieldForTraditionalLogin?e.AskRequiredFieldsOnTraditionalLogin:p.askRequiredFieldForTraditionalLogin,p.stayLogin=void 0===p.stayLogin?e.IsRememberMe:p.stayLogin,p.disableSignup=void 0===p.disableSignup?e.IsDisabledRegistration:p.disableSignup,p.riskBasedAuthentication=void 0===p.riskBasedAuthentication?e.IsRiskBasedAuthentication:p.riskBasedAuthentication,p.noCallbackForSocialLogin=void 0===p.noCallbackForSocialLogin?e.IsNoCallbackForSocialLogin:p.noCallbackForSocialLogin,p.usernameLogin=void 0===p.usernameLogin?e.IsUserNameLogin:p.usernameLogin,p.promptPasswordOnSocialLogin=void 0===p.promptPasswordOnSocialLogin?e.AskPasswordOnSocialLogin:p.promptPasswordOnSocialLogin,p.v2Recaptcha=void 0===p.v2Recaptcha?e.IsV2Recaptcha:p.v2Recaptcha,p.invisibleRecaptcha=void 0===p.invisibleRecaptcha?e.IsInvisibleRecaptcha:p.invisibleRecaptcha,p.askOptionalFieldsOnRegistration=void 0===p.askOptionalFieldsOnRegistration?e.AskOptionalFieldsOnSocialSignup:p.askOptionalFieldsOnRegistration,p.askEmailForUnverifiedProfileAlways=void 0===p.askEmailForUnverifiedProfileAlways?e.AskEmailIdForUnverifiedUserLogin:p.askEmailForUnverifiedProfileAlways,p.logoutOnVerifyEmail=void 0===p.logoutOnVerifyEmail?e.IsLogoutOnEmailVerification:p.logoutOnVerifyEmail,p.disableAccountLinking=e.IsDisabledAccountLinking,p.duplicateEmailWithUniqueUsername=e.DuplicateEmailWithUniqueUsername,p.customDomain=p.customDomain||e.CustomDomain,p.optionalRecaptchaConfiguration=e.OptionalRecaptchaConfiguration,p.tencentCaptchaAppid=void 0===p.tencentCaptchaAppid?e.QQTencentCaptchaKey:p.tencentCaptchaAppid,p.privacyPolicyConfiguration=e.PrivacyPolicyConfiguration,p.isConsentManagementEnabled=void 0===p.IsConsentManagementEnabled?e.IsConsentManagementEnabled:p.IsConsentManagementEnabled,o.isPINAuthentication=!1,e.PINAuthentication&&e.PINAuthentication.IsEnabled&&(o.isPINAuthentication=!0,o.PINConfiguration=Object.assign({},e.PINAuthentication.Configuration),p.PINConfiguration?p.PINConfiguration=Object.assign({},o.PINConfiguration,p.PINConfiguration):p.PINConfiguration=Object.assign({},o.PINConfiguration)),p.isPINAuthentication=o.isPINAuthentication,p.isPINAuthentication){u.pinSchema=[];var l=m.findInSchema(p.RegistrationFormSchema,"name","pin");if(m.isEmpty(l))u.log("Pin schema is not defined");else{u.pinSchema.push(l),!p.PINConfiguration.IsRequired||u.pinSchema[0].rules&&-1!==u.pinSchema[0].rules.indexOf("required")||(u.pinSchema[0].rules=u.pinSchema[0].rules?[u.pinSchema[0].rules,"required"].join("|"):"required");var c=m.findInSchema(p.RegistrationFormSchema,"name","confirmpin");m.isEmpty(c)||u.pinSchema.push(c)}}p.isConsentManagementEnabled&&d.setConsentTemplate()}(e),p=m.mergeOptions(t,p),u.options=p;for(var o=0;o<n.length;o++)n[o]()},"registrationSchema"))}u.getConsentConfiguration=function(s){u.isConsentApiCallingStarted||""!==u.consentOptions?s(u.consentOptions):(u.isConsentApiCallingStarted=!0,m.ajaxCall("get",LoginRadiusDefaults.configApiDomain+"consent?apiKey="+u.options.apiKey,"",function(e){if(e){u.consentOptions={},u.consentsList={};for(var o="",t=0;t<e.length;t++){for(var n=0;n<e[t].Events.length;n++)o=e[t].Events[n].Name,"true"===e[t].Events[n].IsCustom&&(o="custom_"+o),u.consentOptions[o]={},u.consentOptions[o].ConsentForm=e[t].ConsentForm,u.consentOptions[o].TermOfService=e[t].TermOfService,u.consentOptions[o].PrivacyPolicy=e[t].PrivacyPolicy;for(var i=0;i<e[t].ConsentForm.length;i++)for(var a=e[t].ConsentForm[i],r=0;r<a.Consents.length;r++)u.consentsList[a.Consents[r].ConsentId]||(u.consentsList[a.Consents[r].ConsentId]=a.Consents[r])}s(u.consentOptions)}else u.isConsentApiCallingStarted=!1}))},u.getAppConfiguration=i,u.progressiveProfiling=new LRNameSpace.ProgressiveProfiling(u,d,e,LoginRadiusDefaults),u.progressiveProfiling.init=function(){i(function(){u.progressiveProfiling.fetchSchema(function(e){u.progressiveProfilingSchema=e,u.$hooks.register("registrationSchemaFilter",function(e,o){u.options.progressiveProfilingTraditional&&(u.LoggedinSocialProvderProfile=o)})},"progressiveProfilingSchema")})}}function LoginRadiusHooksModel(C){var u=C.util;C.$hooks={hooks:[],register:function(e,o,t){void 0===C.$hooks.hooks[e]&&(C.$hooks.hooks[e]=[]),parseInt(t,10)===t&&C.$hooks.hooks[e].length>t+1?C.$hooks.hooks[e].splice(t,0,o):C.$hooks.hooks[e].push(o)},call:function(e){var o=Array.prototype.splice.call(arguments,1);if(void 0!==C.$hooks.hooks[e])for(var t=0,n=C.$hooks.hooks[e].length;t<n;++t)C.$hooks.hooks[e]&&C.$hooks.hooks[e][t]&&C.$hooks.hooks[e][t].apply(null,o)}},C.$hooks.register("addEventOnElement",function(e){u.extend(C.eventsName,e)}),C.$hooks.register("mapErrorMessages",function(e){if(e.code&&e.message)C.errorMessages.push(e);else if(u.isArray(e))for(var o=0;o<e.length;o++)e[o].code&&e[o].message?C.errorMessages.push(e[o]):C.log(notValidMessage);else C.log(notValidMessage)}),C.$hooks.register("passwordMeterConfiguration",function(e){u.isArray(e)?u.extend(C.passwordMeterConfiguration,e):C.log(passwordStrengthMessage)}),C.$hooks.register("setButtonsName",function(e){for(var o,t=Object.keys(e),n=t.length,i={};n--;)i[(o=t[n]).toLowerCase()]=e[o];u.extend(C.buttonsName,i)}),C.$hooks.register("mapValidationMessages",function(e){if(e.rule&&e.message)C.validationMessages.push(e);else if(u.isArray(e))for(var o=0;o<e.length;o++)e[o].rule&&e[o].message?C.validationMessages.push(e[o]):C.log(notValidMessage);else C.log(notValidMessage)}),C.$hooks.register("customizeFormLabel",function(e){u.extend(C.formCustomLabel,e)}),C.$hooks.register("customizeElementTitle",function(e){u.extend(C.formElementsTitle,e)}),C.$hooks.register("defaultChoiceOption",function(e){u.extend(C.defaultOptionField,e)}),C.$hooks.register("customizeFormPlaceholder",function(e){u.extend(C.formPlaceholder,e)}),C.$hooks.register("formValidationRules",function(e){u.extend(C.formValidations,e)}),C.$hooks.register("formAttributes",function(e){u.extend(C.formElementAttributes,e)}),C.$hooks.register("buttonAttributes",function(e){u.extend(C.buttonElements,e)}),C.$hooks.register("addFormCaptcha",function(i,a,r){C.getAppConfiguration(function(){r&&(C.options[r]=!0);var e=i+"recaptcha_widget";u.addRecaptchaJS();var o=[];u.captchaSchema(e,o,!1,a);var t=document.createElement("div");if(t.setAttribute("name",o[0].name),C.options.invisibleRecaptcha){var n=a.toString();n=/function ([^\(]*)/.exec(n)[1],o[0].html=o[0].html.replace("onCaptchaSubmit",n)}t.innerHTML=o[0].html,u.addHTMLContent(i,t,!0),u.renderV2Recaptcha(e,!1,a)})}),C.$hooks.register("addFormCaptchaExecute",function(e){var o=e+"recaptcha_widget",t=u.elementById(o+"_tencent");if(C.options.invisibleRecaptcha)var n=setInterval(function(){if("undefined"!=typeof grecaptcha){try{grecaptcha.execute(window[o])}catch(e){}clearInterval(n)}},1e3);else t&&"none"!==t.style.display&&(C.options.tencentCaptcha||C.options.tencentCaptchaAsFallback&&!window.grecaptcha)&&t.click()}),C.$hooks.register("successCallback",function(o,t,e){var n,i,a="";if(o&&(C.$hooks.register("setCurrentAction",function(){C.storage.setBrowserStorage("LRSetSafariToken",o)}),a="verifyotp"===o.toLowerCase()?"otp":o.toLowerCase()),"1132"==t.ErrorCode){C.options.v2Recaptcha||C.options.invisibleRecaptcha||C.options.tencentCaptcha||C.options.tencentCaptchaAsFallback||(C.options.v2Recaptcha=!0),"verifyemail"===a&&(u.elementById("loginradius-submit-verify").style.display="block");var r=C.LRPrefix.replace("##","")+"recaptcha_widget_"+a;n=r,(i=C.util.elementById(n,!0))&&(i.style.display="block"),window.grecaptcha&&i&&""!==i.innerHTML?grecaptcha.reset(window[n+"lr_recaptcha_widgets_idprefix"]):C.util.renderV2Recaptcha(n,!1)}else"1148"==t.ErrorCode||"1165"==t.ErrorCode?function(e,a){if(C.options.securityQuestionEnabled){var r=u.jsonToQueryString(JSON.parse(e));e="string"==typeof e||e instanceof String?JSON.stringify(u.parseQueryString(e)):JSON.stringify(e),new LoginRadiusControllers(C).getSecurityQuestionsController(r,function(i){if(0<i.length)for(var e=0;e<i.length;e++)-1!==r.indexOf(i[e].name)&&i.splice(e,1);if(0<i.length){var o=document.createElement("div"),t=[],n=C.LRPrefix.split("##");new SetLoginRadiusCommonFunctions(C).createFormFields(i,o,a,t,n[0],n[1]),new FormValidator(n[1]+a,t,function(e){C.mergeFormErrors={},C.mergeFormErrors=e}),C.$hooks.register("startProcess",function(e,o){for(var t={},n=0;n<i.length;n++)o&&o[i[n].name]&&(t[i[n].name]=o[i[n].name],delete o[i[n].name]);o.securityanswer=t}),C.util.addHTMLContent("",o,!0,a,n[0])}})}}(e,a):"1194"==t.ErrorCode?function(o,e){var t="",n=C.privacyPolicySchema.slice();n[0].rules="Strict"===C.options.privacyPolicyConfiguration.Mode?"required":"";var i=new SetLoginRadiusCommonFunctions(C),a=new LoginRadiusControllers(C,i);C.$hooks.call("getCurrentActionOptions",e);var r=C.currentActionOptions.onSuccess||function(){},s=C.currentActionOptions.onError||function(){},l=C.currentActionOptions.classPrefix||"";"socialLogin"===e?(t=C.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),C.$hooks.call("socialLoginFormRender")):t=o.Data.access_token;i.createForm(n,"privacyPolicyUpdate",C.currentLRContainer,function(e){a.updatePrivacyPolicy(t,o,r,s,null,C.currentLRContainer,l)},function(e){s(i.setMappedMessage(e))})}(t,o):"1243"==t.ErrorCode?function(e,o){if(C.pinSchema&&C.pinSchema.length){var t=e.Data.PINAuthToken,n=new SetLoginRadiusCommonFunctions(C);n.setPINRule(u.findInSchema(C.pinSchema,"name","confirmpin"));var i=new LoginRadiusControllers(C,n);C.$hooks.call("getCurrentActionOptions",o);var a=C.currentActionOptions.onSuccess||function(){},r=C.currentActionOptions.onError||function(){},s=C.currentActionOptions.classPrefix||"";n.createForm(C.pinSchema,"pinSetup",C.currentLRContainer,function(e){i.configurePINController(t,e,a,r,C.currentLRContainer,s)},function(e){r(n.setMappedMessage(e))})}else C.log("Pin Schema is not defined in the schema")}(t,o):1226===t.ErrorCode&&t.Data&&t.Data.ConsentToken&&!C.lrApiFramework&&C.getConsentConfiguration(function(e){!function(e,o,t){var l,c=e.Data.ConsentToken;e.Data.ConsentProfile&&e.Data.ConsentProfile.Consents&&e.Data.ConsentProfile.Consents.Options&&(l=e.Data.ConsentProfile.Consents.Options);for(var u=new SetLoginRadiusCommonFunctions(C),p=new LoginRadiusControllers(C,u),d="",m=[],g=[],n=0;n<e.Data.Events.length;n++)m.push(e.Data.Events[n].Name);C.$hooks.call("getCurrentActionOptions",o);var f=C.currentActionOptions.onSuccess||function(){},h=C.currentActionOptions.onError||function(){},v=C.currentActionOptions.classPrefix||"",y=function(r,s){var e=[],o=u.createConsentInterface(r[s],l);""!==o&&(e.push({html:o,type:"html",name:"consent"}),u.createForm(e,"consentlogin",C.currentLRContainer,function(e){var o=u.consentValidation(e,s);if(0<o.length)h(u.setMappedMessage(o));else if(d=d?d+"&"+e:e,g.push({Event:s,IsCustom:!1}),m.splice(0,1),0<m.length)y(r,m[0],l);else{var t=C.util.parseQueryString(d),n=[];for(var i in t){var a=i.replace("consent_","");n.push({ConsentOptionId:a,IsAccepted:t[i]})}t={},0<n.length&&(t.Events=g,t.Data=n),p.submitConsentController(c,t,f,h,C.currentLRContainer,v)}},function(e){h(u.setMappedMessage(e))}))};y(t,m[0])}(t,o,e)})}),C.$hooks.register("afterFormRender",function(e,o,t,n){var i=C.options.RegistrationFormSchema,a=[];if("registration"===e){for(var r,s={},l=0;l<i.length;l++)i[l]&&i[l].DataSource&&null!==i[l].DataSource&&(s[i[l].DataSource]=i[l],s[i[l].DataSource].children=[]);for(var c in s)s.hasOwnProperty(c)&&((r=s[c]).ParentDataSource&&null!=r.ParentDataSource?s[r.ParentDataSource].children.push(r):a.push(r));0<a.length&&function(r,e,s){for(var l=[],c=new SetLoginRadiusCommonFunctions(C),o=0;o<e.length;o++)e[o].ParentDataSource||u.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+e[o].DataSource+"?apiKey="+C.options.apiKey,"",function(e,o){if(l[e.DataSource]=o,l[e.DataSource])for(var t=0;t<l[e.DataSource].length;t++){var n=document.createElement("option");n.setAttribute("value",l[e.DataSource][t].Id),n.appendChild(document.createTextNode(l[e.DataSource][t].Key));var i=document.getElementById(s+"registration-"+e.name);i&&i.appendChild(n)}if(e&&e.children&&0<e.children.length)for(var a=0;a<e.children.length;a++)c.addChangeEventHandler(r,e,e.children[a],s)},"registration",e[o])}(o,a,t)}"validatecode"===e&&function(i,e,a){for(var o=0;o<e.length;o++)e[o].DataSource&&C.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+e[o].DataSource+"?apiKey="+C.options.apiKey,"",function(e,o){for(var t=0;t<o.length;t++){var n=document.createElement("option");n.setAttribute("value",o[t].Id),n.appendChild(document.createTextNode(o[t].Key)),document.getElementById(a+i+"-"+e.name).appendChild(n)}},"registration",e[o])}(e,i,t)}),C.$hooks.register("setLocaleBasedInfo",function(e){for(var o in e)if(e.hasOwnProperty(o))switch(o){case"labels":u.extend(C.formCustomLabel,e[o]);break;case"placeholders":u.extend(C.formPlaceholder,e[o]);break;case"validationMessages":C.$hooks.call("mapValidationMessages",e[o]);break;case"errorMessages":C.$hooks.call("mapErrorMessages",e[o]);break;case"passwordMeterConfiguration":C.$hooks.call("passwordMeterConfiguration",e[o]);break;case"buttonsName":C.$hooks.call("setButtonsName",e[o])}})}function SetLoginRadiusCommonFunctions(D){var O=this,A=LoginRadiusDefaults.messages,k=LoginRadiusDefaults.buttonNames;function F(){var n={0:"worst",1:"bad",2:"weak",3:"good",4:"strong",5:"secure"},i={0:"#dd514c",1:"orange",2:"yellow",3:"#5eb95e",4:"blue",5:"violet"},a={0:"Worst",1:"Bad",2:"Weak",3:"Good",4:"Strong",5:"Secure"};return function(){var e=[],o=D.passwordMeterConfiguration;for(var t in n)o[t]&&o[t].case?o[t].case.toLowerCase()===n[t]&&e.push({color:o[t].color?o[t].color:i[t],Message:o[t].message?o[t].message:a[t]}):e.push({color:i[t],Message:a[t]});return e}()}function T(t,n,e){var o=D.util.elementById(e+"_tencent"),i=D.util.elementById(e);window.grecaptcha&&D.options.invisibleRecaptcha&&i&&""!==i.innerHTML&&"none"!==i.style.display?grecaptcha.execute(window[e+"lr_recaptcha_widgets_idprefix"]):o&&"none"!==o.style.display&&(D.options.tencentCaptcha||D.options.tencentCaptchaAsFallback&&!window.grecaptcha)?window.onTencentCaptchaSubmitCallback=function(e){var o=D.util.serialize(t);o+="&qq_captcha_ticket="+e.ticket,o+="&qq_captcha_randstr="+e.randstr,n(o)}:n(D.util.serialize(t))}function L(e,o,t,n,i){var a="linksignin";"passwordlessLoginOTPButtonLabel"===e&&(a="otpsignin");var r=document.createElement("input");r.type="submit";var s=D.buttonsName[e.toLowerCase()]||k[e.toLowerCase()],l=k[e.toLowerCase()];r.value=s,r.id=n+a+"-"+l.toLowerCase().replace(/ /g,"-"),r.setAttribute("class",i+a+" "+a+"-"+n+l.toLowerCase().replace(/ /g,"-")),D.options.disableButtonOnsubmit&&(D.$hooks.register("startProcess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(r.disabled=!0)}),D.$hooks.register("xhrEndWithError",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&(r.disabled=!1)}),D.$hooks.register("xhrEndWithSuccess",function(e){("otpsignin"===a&&window.lrpasswordlessloginotp||"linksignin"===a&&window.lrpasswordlesslogin)&&D.options.enableSubmitOnSuccess&&(r.disabled=!1)})),o.appendChild(r),D.util.addEvent("click",t,function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1}),"passwordlessLoginOTPButtonLabel"===e?D.util.addEvent("click",r,function(e){window.lrpasswordlessloginotp=!0,window.lrpasswordlesslogin=!1}):D.util.addEvent("click",r,function(e){window.lrpasswordlesslogin=!0,window.lrpasswordlessloginotp=!1})}O.renderCustomInterface=function(e,P,R,b,E,o){D.options.selector=e;function t(e){var o,t=e;D.options.providerCountry&&!D.options.providersList&&(t=function(e,o){for(var t=[{Name:"Facebook",country:"global",except:"china"},{Name:"Google",country:"global",except:"china"},{Name:"Yahoo",country:"global",except:"china"},{Name:"Live",country:"global",except:"china"},{Name:"Twitter",country:"global",except:"china"},{Name:"Linkedin",country:"global",except:"china"},{Name:"Myspace",country:"US"},{Name:"Foursquare",country:"global",except:"china"},{Name:"Vkontakte",country:"Russia"},{Name:"Renren",country:"China"},{Name:"QQ",country:"China"},{Name:"Kaixin",country:"China"},{Name:"Github",country:"global",except:"china"},{Name:"Mailru",country:"Russia"},{Name:"Amazon",country:"US"},{Name:"Paypal",country:"global"},{Name:"Salesforce",country:"global"},{Name:"ODNOKLASSNIKI",country:"Russia"},{Name:"WORDPRESS",country:"global"},{Name:"GOOGLEPLUS",country:"global",except:"china"},{Name:"Disqus",country:"global",except:"china"},{Name:"INSTAGRAM",country:"global",except:"china"},{Name:"SINAWEIBO",country:"China"},{Name:"XING",country:"Germany"},{Name:"PINTEREST",country:"global",except:"china"},{Name:"LINE",country:"global"},{Name:"AOL",country:"US"}],n=0;n<t.length;n++)for(var i=0;i<o.length;i++)if(o[i]&&o[i].Name.toLowerCase()===t[n].Name.toLowerCase()){if(t[n].country.toLowerCase()===e.toLowerCase()||"global"===t[n].country.toLowerCase()&&!t[n].except||t[n].except&&t[n].except.toLowerCase()!==e.toLowerCase())continue;o.splice(i,1)}return o}(D.options.providerCountry,t)),D.$hooks.call("socialInterfaceProviders",t),D.options.providersList&&(o=D.options.providersList);var n=D.options.hashTemplate?D.util.hashTmpl:D.util.tmpl,i=R.split(","),a=D.util.getQueryParameterByName("scope");""===D.options.scope&&a&&(D.options.scope=a);var r="&callback="+D.options.callbackUrl+"&same_window="+D.options.callbackInsideSameWindow+"&is_access_token="+D.options.accessTokenResponse+"&callbacktype="+D.options.callbackType+"&disablesignup="+D.options.disableSignup;-1===r.indexOf("scope")&&(r+="&scope="+D.options.scope),D.options.isMobile&&(r+="&ismobile=true"),E&&(r+="&ac_linking=true"),D.options.isCustomScope&&(r+="&is_custom_scope=true");for(var s=D.util.getThisObjectName(),l=0;l<i.length;l++){var c=D.util.elementById(i[l]);if(c)-1!==c.innerHTML.indexOf("ac_linking")&&(r=r.replace("&ac_linking=true",""));var u=[];I[l]="";for(var p=0;p<t.length;p++){t[p].ObjectName=s,-1===t[p].Endpoint.indexOf("callback=")&&(t[p].Endpoint+=r);var d={islinked:!1,providerId:!1};P&&P[t[p].Name.toLowerCase()]&&(d.islinked=!0,d.providerId=P[t[p].Name.toLowerCase()]),t[p].isLinked=d.islinked,t[p].providerId=d.providerId;var m=D.options.unLinkAccountCallbackUrl||window.location.href;m+=-1===m.indexOf("?")?"?":"&";var g=t[p];u.push(g)}for(var f=[],h=0;h<u.length;h++)u[h].isLinked&&f.push(u[h]);if(0<f.length){for(var v=0;v<u.length;v++)u[v].isLinked||f.push(u[v]);u=f}for(var y=0;y<u.length;y++)""!==i[l]&&(void 0!==o&&-1===o.indexOf(u[y].Name)&&-1===o.indexOf(u[y].Name.toLowerCase())||(I[l]+=n(i[l],u[y])))}for(var C=D.options.selector.split(","),w=0;w<C.length;w++){var k=C[w];if(0===k.indexOf(".")){k=k.replace(".","");var T=D.util.elementsByClass(k);if(T&&0<T.length)for(var L=0;L<T.length;L++)b?T[L].innerHTML+=I[w]:T[L].innerHTML=I[w]}else if(""!==k){var S=D.util.elementById(k);S&&(b?S.innerHTML+=I[w]:S.innerHTML=I[w])}}}var I=[];o?t(o):void 0!==D.options.SocialSchema&&t(D.options.SocialSchema.Providers)},O.mapRegistrationSchema=function(e,o,t){var n=D.util.parseQueryString(o),i={},a={},r={},s=[],l=[];for(var c in n){if(-1!==c.indexOf("cf_"))i[c.replace("cf_","")]=n[c],delete n[c];else if(-1!==c.indexOf("consent_")){o={ConsentOptionId:c.replace("consent_",""),IsAccepted:n[c]};l.push(o),delete n[c]}else if("emailsubscription"===c)n.IsEmailSubscribed=!("on"!==n[c]&&"true"!==n[c]),delete n[c];else if("emailid"===c||"email"===c)a.value=n[c],a.type="Primary";else if("SecurityQuestionAnswer"!==c&&-1!==c.indexOf("securityQuestion")){for(var u={},p=0;p<D.options.securityQuestionsCount;p++)n["securityAnswer"+p]&&n["securityQuestion"+p]&&(u[n["securityQuestion"+p]]=n["securityAnswer"+p]),delete n["securityQuestion"+p],delete n["securityAnswer"+p];0!==Object.keys(u).length&&(n.SecurityQuestionAnswer=u)}else if("country"===c)r=-1!==n[c].indexOf("|")?{code:n[c].split("|")[0],name:n[c].split("|")[1]}:{code:"",name:n[c]};else{var d=D.util.findInSchema(e,"name",c);if(d&&d.Parent){var m=-1!==c.indexOf("_")?c.split("_")[1]:c;if(void 0===n[d.Parent]){n[d.Parent]=[];var g={};g[m]=n[c],"Addresses"===d.Parent?g.type="personal":"PhoneNumbers"!==d.Parent||g.phonetype||(g.phonetype="default"),n[d.Parent].push(g)}else"Addresses"!==d.Parent||n[d.Parent][0].type||(n[d.Parent][0].type="personal"),n[d.Parent][0][m]=n[c];delete n[c]}}}return 0!==Object.keys(i).length&&(n.CustomFields=i),0!==Object.keys(a).length&&(s.push(a),n.email=s),0!==Object.keys(r).length&&(n.country=r),D.options.isPINAuthentication&&D.options.PINConfiguration.AskOnRegistration&&(n=O.sanitizePinData(n)),0<l.length&&(n.Consents={Events:[{Event:"Register",IsCustom:!1}],Data:l}),n};var s=!(O.showQRCode=function(e,o,t,n,i,a,r){var s=D.QRCodeSchema.slice();D.options.maskSensitiveInput?s[0].type="password":s[0].type="string";function l(e,o){if(e&&s.splice(0,0,{type:"image",name:"qrcode",display:"QR Code",rules:"",permission:"r",value:e}),o){var t=i||LoginRadiusDefaults.classPrefix;s.splice(1,0,{type:"button",name:"ManualEntryCode",display:"Get Manual Entry Code",rules:"",permission:"r",title:"Use this code when you unable to scan QR code. Tap 'Enter a provided key' then enter the email address of your Account and enter this key in your authenticator app",event:"click",eventCallback:function(e){document.getElementsByClassName("content-"+t+"ManualEntryCode")[0].innerHTML=o}})}}var c,u,p=!0,d=new LoginRadiusControllers(D,O);if(e.SecondFactorAuthentication)c=e.SecondFactorAuthentication.QRCode,u=e.SecondFactorAuthentication.ManualEntryCode,e.SecondFactorAuthentication.IsGoogleAuthenticatorVerified||l(c,u);else if(p=!1,c=e.QRCode,u=e.ManualEntryCode,e.IsGoogleAuthenticatorVerified){if("false"!==D.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)&&D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication){var m=D.util.getButtonAttribute("disablegoogleauthenticator",i);D.util.addHTMLContent(o,m),D.util.addEvent("click",m,function(e){d.resetTwoFactorAuthenticationController("googleauthenticator",t,n)})}}else p=!0,l(c,u);p&&O.createForm(s,"showQRcode",o,function(e){d.verify2FAOTPController(e,t,n,a,r)},function(e){n(e)},i)});O.socialLogin=function(t,n,i,a){var r=new LoginRadiusControllers(D,O);window.html5passToken=function(e){if(!s){s=!0,t=LoginRadiusDefaults.socialRegFormId||t;var o=D.storage.getBrowserStorage("LRSetSafariToken");o&&(D.$hooks.call("getCurrentActionOptions",o),n=window.LRSafarionSuccess||n,i=window.LRSafarionError||i),r.socialLoginReceiveToken(e,t,n,i,a)}};var e=D.util.getHashParam("lr-token");e&&window.html5passToken(e),D.loginRadiusHtml5PassToken=window.html5passToken,D.options.isMobile||D.options.noCallbackForSocialLogin?D.$hooks.register("socialCalls",function(e,o){if(D.options.noCallbackForSocialLogin){O.pingForSmartLogin(o,function(e){e.access_token?r.socialLoginReceiveToken(e.access_token,t,n,i,a):n(e)},function(){})}}):D.util.addEvent("message",window,function(e){-1===e.origin.indexOf(D.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||(t=LoginRadiusDefaults.socialRegFormId||t,"string"==typeof e.data&&LoginRadiusDefaults._uuidFormat.test(e.data)&&r.socialLoginReceiveToken(e.data,t,n,i,a))})},O.resetPassword=function(o,t,n,i,a){var r,s,e=D.resetPasswordFormSchema.slice(),l=new LoginRadiusControllers(D,O);if(null==D.util.getHashParam("vtype")){var c,u;if(e=D.resetPasswordByPhoneSchema.slice(),O.setPasswordRule(D.util.findInSchema(e,"name","password")),a)a.email?(c="email",u=a.email):a.username&&(c="username",u=a.username),e.push({type:"hidden",name:c,value:u});else if(D.options.phoneLogin&&(s="&"+LoginRadiusDefaults.LRPhoneNo,!D.util.findInSchema(e,"name","resendotp"))){var p=Object.assign({},D.btnOTPSchema,{name:"resendotp",display:"Resend OTP",eventCallback:function(e){l.forgotPasswordbyPhoneController(LoginRadiusDefaults.LRPhoneNo,o,t,n,i,function(){})}});e.push(p)}}else{O.setPasswordRule(D.util.findInSchema(e,"name","password")),O.setPasswordRule(D.util.findInSchema(e,"name","confirmpassword"));var d=D.util.getHashParam("vtoken");if(d)if(D.options.verifyEmailByOTP){var m=D.util.getQueryParameterByName("email");r="&otp="+d,r+="&email="+encodeURIComponent(m.replace(/ /g,"+")),e.splice(2,1)}else D.resetPasswordFormSchema[2].value=d;else n([{Message:"Verification Token not found in query string."}])}O.createForm(e,"resetpassword",o,function(e){-1===e.indexOf("otp")||a?(r&&(e+=r),l.resetPasswordController(e,t,n,o,i)):l.resetPasswordByPhoneController(e+s,t,n,o,i)},function(e){n(e)},i)},O.resetPIN=function(o,t,n,i,a){var r,s,e=D.resetPINFormSchema.slice(),l=new LoginRadiusControllers(D,O);if(null==D.util.getHashParam("vtype")){var c,u;if(e=D.resetPINByPhoneSchema.slice(),O.setPINRule(D.util.findInSchema(e,"name","pin")),a)a.email?(c="email",u=a.email):a.username&&(c="username",u=a.username),e.push({type:"hidden",name:c,value:u});else if(D.options.phoneLogin&&(s="&"+LoginRadiusDefaults.LRPhoneNo,!D.util.findInSchema(e,"name","resendotp"))){var p=Object.assign({},D.btnOTPSchema,{name:"resendotp",display:"Resend OTP",eventCallback:function(e){l.forgotPINbyPhoneController(LoginRadiusDefaults.LRPhoneNo,o,t,n,i,function(){})}});e.push(p)}}else{O.setPINRule(D.util.findInSchema(e,"name","pin")),O.setPINRule(D.util.findInSchema(e,"name","confirmpin"));var d=D.util.getHashParam("vtoken");if(d)if(D.options.verifyEmailByOTP){var m=D.util.getQueryParameterByName("email");r="&otp="+d,r+="&email="+encodeURIComponent(m.replace(/ /g,"+")),e.splice(2,1)}else D.resetPINFormSchema[2].value=d;else n([{Message:"Verification Token not found in query string."}])}O.createForm(e,"resetpin",o,function(e){-1===e.indexOf("otp")||a?(r&&(e+=r),l.resetPINController(e,t,n,o,i)):l.resetPINByPhoneController(e+s,t,n,o,i)},function(e){n(e)},i)},O.setPasswordRule=function(e,o){D.options.passwordLength=D.options.passwordlength||D.options.passwordLength;var t=D.util.findInSchema(D.options.RegistrationFormSchema,"name","password").rules;if(e&&e.rules){var n=new RegExp(/matches\[\w*\]/).exec(e.rules);if(n){var i=n[0];e.rules=[t,i].join("|")}else e.rules=t;D.options.passwordLength&&D.options.passwordLength.min&&D.options.passwordLength.max&&(e.rules=e.rules||"",e.rules=e.rules.replace("min_length[6]","min_length["+D.options.passwordLength.min+"]").replace("max_length[32]","max_length["+D.options.passwordLength.max+"]"))}(o=o||!1)&&e&&(e.rules="required")},O.setPINRule=function(e){if(D.pinSchema&&D.pinSchema.length){var o=D.pinSchema[0].rules;if(e&&e.rules){var t=new RegExp(/matches\[\w*\]/).exec(e.rules);if(t){var n=t[0];e.rules=[o,n].join("|")}else e.rules=o;D.options.PINConfiguration.IsRequired&&-1===e.rules.indexOf("required")&&(e.rules=e.rules?[e.rules,"required"].join("|"):"required")}}},O.changeNumberForm=function(o,e,t,n,i,a,r,s){var l=D.util.getButtonAttribute("changenumber",i),c=D.util.getButtonAttribute("disableotpauthenticator",i),u=D.storage.getBrowserStorage(LoginRadiusDefaults.storedGAAuth),p=D.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e?(e.appendChild(l),p&&!D.LRCheckLogin&&(D.options.optionalTwoFactorAuthentication||"false"!==u&&D.options.twoFactorAuthentication)&&e.appendChild(c)):(D.util.addHTMLContent(o,l,a),p&&!D.LRCheckLogin&&(D.options.optionalTwoFactorAuthentication||"false"!==u&&D.options.twoFactorAuthentication)&&D.util.addHTMLContent(o,c,!0)),D.util.addEvent("click",c,function(e){new LoginRadiusControllers(D,O).resetTwoFactorAuthenticationController("otpauthenticator",t,n)}),D.util.addEvent("click",l,function(e){document.getElementsByName(i+"changePhone")[0]||O.updatePhoneNumber(o,t,n,i,"changePhone",r,s)})},O.validateAndCall=function(e){LoginRadiusDefaults.isSSOInitFired?D.options.appName?e():D.log("LoginRadius site name (app name) required to do SSO"):D.log("Init method should be called first then login.")},O.logout=function(n){O.validateAndCall(function(){var e=D.options.tokenExpire?"?tokenExpire=1":"",o=D.options.tokenExpire?"tokenExpire":"logout",t=D.options.customDomain||D.options.appName+"."+LoginRadiusDefaults.hubDomain;D.util.ajaxCall("get","https://"+t+"/ssologin/"+o+e,"",function(e){LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,D.options.appPath),D.clearSession(),n&&n()})})},O.otpEmailVerification=function(t,n,i,a,r){var e=D.otpSchema;O.createForm(e,"otp",t,function(e){var o="";o="string"!=typeof r?(e=D.util.parseQueryString(e),D.util.mergeOptions(r,e)):r+"&"+e,new LoginRadiusControllers(D,O).emailVerificationController(o,n,i,t,a,!0)},function(e){i(e)},a)},O.loginHandleToken=function(e,o,t,n,i,a){if(LoginRadiusDefaults.lrResponseCounter=0,LoginRadiusDefaults.lrCounterJwtResponse="",LoginRadiusDefaults.lrCounterTokenResponse="",e)if(e.ErrorCode)n(O.loginRadiusErrorTojsError(e));else{if(e.Data&&e.Data.hasOwnProperty("Profile")&&(delete(e=e.Data).Data,delete e.IsPosted),D.options.privacyPolicyConfiguration.IsEnabled&&e.Profile){var r=!1;e.Profile.PrivacyPolicy&&e.Profile.PrivacyPolicy.Version&&(r=O.checkForLatestPrivacyPolicy(e.Profile)),e.Profile=Object.assign({},e.Profile,{IsLatestPrivacyPolicy:r})}function s(){D.LoginRadiusHostedPage&&LRNameSpace.cookies.setItem("lr-session-token",e.access_token),LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse=e,D.options.tokenType&&"jwt"===D.options.tokenType.toLowerCase()?2===LoginRadiusDefaults.lrResponseCounter&&LoginRadiusDefaults.lrCounterJwtResponse&&LoginRadiusDefaults.lrCounterJwtResponse.signature&&(e.jwttoken=LoginRadiusDefaults.lrCounterJwtResponse.signature,null!=o&&""!==o?t(e,D.util.parseQueryString(o)):t(e)):null!=o&&""!==o?t(e,D.util.parseQueryString(o)):t(e)}var l=D.storage.getBrowserStorage("LRSetSafariToken");if(D.storage.removeBrowserStorage("LRSetSafariToken"),D.setHostedToken||l)t(e);else{var c=D.registrationFormSchema&&0<D.registrationFormSchema.length?D.registrationFormSchema:D.options.RegistrationFormSchema,u=D.util.findInSchema(c,"name","phoneid"),p=u&&-1!==u.rules.indexOf("required")&&D.options.phoneLogin,d=e.Profile||e.Data,m=!(D.options.disabledEmailVerification||D.options.optionalEmailVerification);if(d&&!d.EmailVerified&&m&&!a)n([O.setMappedMessage(A.emailNotVerified)]);else if(p&&d&&!d.PhoneIdVerified&&!a)if(d.PhoneId){var g={phone:d.PhoneId},f=D.currentLRContainer,h=new LoginRadiusControllers(D,O),v=i+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";h.resendOTPController(g,function(){O.verifyOTP("phone="+d.PhoneId,f,t,n,i),O.resendOTP("phone="+d.PhoneId+"&noPhoneVerified=false",f,t,n,i)},n,v,f,i)}else D.log("Phone ID is required field.");else{if(d&&d.Uid&&D.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,d.Uid),D.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,e.access_token),D.options.isPINAuthentication&&D.options.PINConfiguration.PINLogin&&e&&e.session_token&&D.setSessionToken(e),LoginRadiusDefaults.isSSOInitFired&&e.access_token){O.setToken(e.access_token);var y=navigator.userAgent.toLowerCase(),C=!!(-1===y.indexOf("crios")&&-1===y.indexOf("chrome")&&0<=y.indexOf("safari")),w=/ipad|iphone|ipod/.test(y)&&!window.MSStream,k=0<=y.indexOf("ucbrowser"),T=/crios/i.test(y),L=D.options.customDomain||D.options.appName+"."+LoginRadiusDefaults.hubDomain,S=D.util.getQueryParameterByName("vtype"),P=D.util.getQueryParameterByName("vtoken"),R=window.location.href;if(S&&(R=R.replace("?vtype="+S,"").replace("&vtype="+S,"")),P&&(R=R.replace("&vtoken="+P,"").replace("?vtoken="+P,"")),R=encodeURIComponent(R),C||w&&k||w&&T){D.options.askRequiredFieldForTraditionalLogin||D.storage.setBrowserStorage("LRTraditionalLogin",!0),D.$hooks.call("setCurrentAction");if(D.options.stayLogin){var b=D.storage.getBrowserStorage("lr-rememberme");D.storage.removeBrowserStorage("lr-rememberme"),window.location="https://"+L+"/ssologin/setCustomSafariToken?token="+e.access_token+"&apiKey="+D.options.apiKey+"&isrememberMe="+b+"&callback="+R}else window.location="https://"+L+"/ssologin/setSafariToken?token="+e.access_token+"&apiKey="+D.options.apiKey+"&callback="+R}else{var E="",I="setToken";D.options.stayLogin&&(E="&isrememberMe="+D.storage.getBrowserStorage("lr-rememberme"),D.storage.removeBrowserStorage("lr-rememberme"),I="setCustomToken"),D.util.ajaxCall("get","https://"+L+"/ssologin/"+I+"?token="+e.access_token+"&apiKey="+D.options.apiKey+E,"",function(){s()},"setToken")}}else s();D.options.tokenType&&"jwt"===D.options.tokenType.toLowerCase()&&O.getJwtToken(e.access_token,t,n)}}}},O.getJwtToken=function(e,o,t){D.util.ajaxCall("get",LoginRadiusDefaults.cloudApiDomain+"sso/jwt/api/token?apikey="+D.options.apiKey+"&jwtapp="+D.options.integrationName+"&access_token="+e,"",function(e){LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterJwtResponse=e,2===LoginRadiusDefaults.lrResponseCounter&&(e.ErrorCode?t(e):(LoginRadiusDefaults.lrCounterTokenResponse.jwttoken=e.signature,o(LoginRadiusDefaults.lrCounterTokenResponse)))},"JWTToken")},O.mapSchema=function(o,e,t,n){e=D.util.keysToLowerCase(e);var i=[];Object.keys(o).forEach(function(e){i.push(o[e])});for(var a=0;a<o.length;a++)if(null!=o[a])if("emailid"===o[a].name.toLowerCase()&&e.email&&e.email[0]&&e.email[0].value&&""!==e.email[0].value){if(e.emailverified||(D.options.disabledEmailVerification||D.options.optionalEmailVerification)&&!D.options.askEmailForUnverifiedProfileAlways){i[a].value=e.email[0].value,o[a]=null;continue}if(!D.options.askEmailForUnverifiedProfileAlways||D.setHostedToken){i[a]=o[a]=null;continue}}else if("country"===o[a].name.toLowerCase()&&""===o[a].Parent&&e.country&&null!=e.country.name&&""!==e.country.name&&"unknown"!==e.country.name.toLowerCase())i[a].value=e.country.name,e.country.code&&(i[a].value=e.country.code+"|"+i[a].value),o[a]=null;else if("emailsubscription"===o[a].name.toLowerCase()&&e.isemailsubscribed&&""!==e.isemailsubscribed)i[a].value=e.isemailsubscribed,o[a]=null;else if("phoneid"===o[a].name.toLowerCase()&&e.phoneid&&""!==e.phoneid)i[a].value=e.phoneid.replace("+",""),o[a]=null;else if("birthdate"===o[a].name.toLowerCase()&&e.birthdate&&""!==e.birthdate){var r=e.birthdate.replace("-","/").replace("-","/").split("/");if(r[2]&&""!==r[2]){i[a].value=e.birthdate,o[a]=null;continue}}else if("password"===o[a].name.toLowerCase()||"confirmpassword"===o[a].name.toLowerCase()){if(null!=e.password||!D.options.promptPasswordOnSocialLogin&&!D.options.promptPasswordOnFirstLoginForSocial){i[a]=o[a]=null;continue}}else{if(("pin"===o[a].name.toLowerCase()||"confirmpin"===o[a].name.toLowerCase())&&e.pin&&e.pin.pin){i[a]=o[a]=null;continue}if(""!==o[a].Parent&&void 0!==o[a].Parent&&null!==o[a].Parent){if(o[a].Parent&&e[o[a].Parent.toLowerCase()]&&void 0!==e[o[a].Parent.toLowerCase()]){var s=-1!==o[a].name.indexOf("_")?o[a].name.split("_")[1]:o[a].name,l=Object.keys(e[o[a].Parent.toLowerCase()]).length-1;if("object"!=typeof e[o[a].Parent.toLowerCase()]||!e[o[a].Parent.toLowerCase()][l]||!e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]){i[a].value=e[o[a].Parent.toLowerCase()][o[a].name.toLowerCase()],o[a]=null;continue}if(null!=e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]&&void 0!==e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]&&"unknown"!==e[o[a].Parent.toLowerCase()][l][s.toLowerCase()]){i[a].value=e[o[a].Parent.toLowerCase()][l][s.toLowerCase()],o[a]=null;continue}}}else{if(0===o[a].name.indexOf("cf_")&&e.customfields&&e.customfields[o[a].name.replace("cf_","").toLowerCase()]){i[a].value=e.customfields[o[a].name.replace("cf_","").toLowerCase()],o[a]=null;continue}o[a].name&&"object"!=typeof e[o[a].name.toLowerCase()]&&null!=e[o[a].name.toLowerCase()]&&""!==e[o[a].name.toLowerCase()]&&void 0!==e[o[a].name.toLowerCase()]&&"unknown"!==e[o[a].name.toLowerCase()]&&(i[a].value=e[o[a].name.toLowerCase()],o[a]=null)}}if(o=o.filter(function(e){return e}),t&&"profileeditor"===t&&!e.ErrorCode)return i=i.filter(function(e){return e});for(var c=0;c<o.length;c++)if(null!=o[c].rules&&""!==o[c].rules&&-1<o[c].rules.indexOf("required")||D.options.askOptionalFieldsOnRegistration&&!0===e.firstlogin&&"email"!==e.registrationprovider.toLowerCase()||D.options.askOptionalFieldsOnProgressiveSteps&&n||D.askPinOnLogin)return t&&!e.ErrorCode?i=i.filter(function(e){return e}):o;return[]},O.loginRadiusErrorTojsError=function(e){var o=[];return o.push(O.setMappedMessage(e)),o},O.setMappedMessage=function(e){for(var o=0;o<D.errorMessages.length;o++)D.errorMessages[o].code==e.ErrorCode&&(e.Message=D.errorMessages[o].message||e.Message,e.Description=D.errorMessages[o].description||e.Description);return e},O.setCustomLabel=function(e){for(var o=0;o<e.length;o++)e[o]&&D.formCustomLabel[e[o].name]&&(e[o].display=D.formCustomLabel[e[o].name])},O.setCustomTitle=function(e){for(var o=0;o<e.length;o++)e[o]&&D.formElementsTitle[e[o].name]&&(e[o].title=D.formElementsTitle[e[o].name])},O.setPlaceholder=function(e){for(var o=0;o<e.length;o++)e[o]&&D.formPlaceholder[e[o].name]&&(e[o].placeholder=D.formPlaceholder[e[o].name])},O.setValidation=function(e){D.formValidations[e.name]&&(e.rules=D.formValidations[e.name])},O.setAttribute=function(e,o){if(D.formElementAttributes[e.name])for(var t=D.formElementAttributes[e.name].split("&"),n=0;n<t.length;n++){var i=t[n].split("="),a=i.splice(0,1),r=i.join("=");o.setAttribute(a,r)}},O.verifyOTP=function(n,e,i,a,o,r,s){var l=!1,t="otp";D.LRCheck2FA&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)&&!D.LRCheckRegistration&&(l=!0,t="twofaotp");var c=D.otpSchema;O.createForm(c,t,e,function(e){var o,t=new LoginRadiusControllers(D,O);l?t.verify2FAOTPController(e,i,a,r,s):(("string"==typeof n||n instanceof String)&&(n=D.util.parseQueryString(n)),e=D.util.parseQueryString(e),n.phone?o={phone:n.phone}:(n.phoneid||n.phoneId)&&(o={phone:n.phoneid||n.phoneId}),n.onetouchloginflag&&(e.onetouchloginflag=!0),n.haveToken&&(e.haveToken=!0),t.verifyOTPController(e,o,i,a,r,s))},function(e){a(e)},o)},O.resendOTP=function(e,o,t,n,i,a,r){var s={},l=!0;("string"==typeof e||e instanceof String)&&(e=D.util.parseQueryString(e)),e.noPhoneVerified&&(l=!1);var c=!0;e.phoneid||e.phoneId?(c=!1,s={phone:e.phoneid||e.phoneId}):e.phone?(D.socialLoginFlag||(c=!1),s=e):e.phoneNo2FA||e.phoneno2fa?s={phoneno2fa:e.phoneNo2FA||e.phoneno2fa}:e.SecondFactorAuthentication&&e.SecondFactorAuthentication.OTPPhoneNo&&(s={phoneno2fa:e.SecondFactorAuthentication.OTPPhoneNo});var u=D.util.getButtonAttribute("resendotp",i),p=i||LoginRadiusDefaults.classPrefix,d=c?"twofaotp":"otp",m=document.getElementsByName(p+d)[0];m||(d="twofaotp"===d?"otp":"twofaotp",m=document.getElementsByName(p+d)[0]),m&&m.appendChild(u),!D.LRCheckLogin||!c||l&&"false"!==D.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)||O.changeNumberForm(o,m,t,n,p,"",a,r),e.onetouchloginflag&&(s.onetouchloginflag=!0),e.updatePhone&&(s.updatePhone=!0),D.util.addEvent("click",u,function(e){O.resendOTPManually(s,o,t,n,p,a,r)})},O.sendInstantSignInLink=function(e,o,t,n,i){var a=D.util.parseQueryString(e),r=a.emailid||a.email;if(LoginRadiusDefaults.regexExpression.emailRegex.test(r)||D.options.usernameLogin||D.options.duplicateEmailWithUniqueUsername){var s;LoginRadiusDefaults.regexExpression.emailRegex.test(r)?s="email="+r:(D.options.usernameLogin||D.options.duplicateEmailWithUniqueUsername)&&(s="username="+r);var l=D.options.instantLinkLoginEmailTemplate||D.options.passwordlessLoginEmailTemplate;D.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email?apiKey="+D.options.apiKey+"&verificationUrl="+D.options.verificationUrl+"&passwordlesslogintemplate="+l+"&"+s,"",function(e){window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode?t(O.loginRadiusErrorTojsError(e)):o(e)},"passwordlessLogin")}else t([O.setMappedMessage(A.invalidEmail)])},O.sendInstantSignInOtp=function(n,i,a,r,s){var e=D.util.parseQueryString(n),o=e.emailid||e.email;if(LoginRadiusDefaults.regexExpression.phoneRegex.test(o)){var l="phone="+o;D.util.ajaxCall("GET",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp?apiKey="+D.options.apiKey+"&"+l,"",function(e){if(window.lrpasswordlessloginotp=!1,window.lrpasswordlesslogin=!1,e.ErrorCode)a(O.loginRadiusErrorTojsError(e));else if(i(e),e.Data&&e.Data.Sid){var t=new LoginRadiusControllers(D,O);D.$hooks.register("beforeFormRender",function(e,o){if(!D.util.findInSchema(o,"name","resendotp")){var t=Object.assign({},D.btnOTPSchema,{name:"resendotp",display:"Resend OTP",eventCallback:function(e){O.sendInstantSignInOtp(n,i,a,r,s)}});o.push(t)}});var o=D.otpSchema;O.createForm(o,"otp",r,function(e){var o=s+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";t.verifyInstantOTP(e,D.util.parseQueryString(l),i,a,o,r,s)},function(e){a(O.setMappedMessage(e))},s)}},"passwordlessLogin")}else a([O.setMappedMessage(A.invalidPhone)])},O.resendOTPManually=function(e,o,t,n,i,a,r){var s=i+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp",l=new LoginRadiusControllers(D,O);D.LRCheck2FA&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)&&!D.LRCheckRegistration?"false"===D.storage.getBrowserStorage(LoginRadiusDefaults.storedOTPAuth)?l.update2FAPhoneNumberController(e,o,t,n,i,a,r):l.resendOTP2FAController(e,t,n,s,o,i):l.resendOTPController(e,t,n,s,o,i)},O.updatePhoneNumber=function(t,n,i,a,e,r,s){D.LRCheck2FA&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)&&(D.checkPhoneNumberSchema[0].name="phoneNo2FA"),a=a||LoginRadiusDefaults.classPrefix,document.getElementsByName(a+"showQRcode")[0]&&(LoginRadiusDefaults.innerHTML=!0);var o=e||"updatePhone";O.createForm(D.checkPhoneNumberSchema,o,t,function(e){var o=new LoginRadiusControllers(D,O);-1===e.indexOf("phone=")&&(D.options.twoFactorAuthentication||D.options.optionalTwoFactorAuthentication)?o.update2FAPhoneNumberController(e,t,n,i,a,r,s):o.updatePhoneNumberController(e,t,n,i,a,r,s)},function(e){i(e)},a)},O.pingForSmartLogin=function(o,t,n){var i=D.options.autoLoginPingInterval||D.options.smartLoginPingInterval,a=D.options.autoLoginPingCount||D.options.smartLoginPingCount;D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin/ping?apiKey="+D.options.apiKey+"&clientGuid="+o,"",function(e){1139===e.ErrorCode||1140===e.ErrorCode?setTimeout(function(){LoginRadiusDefaults.pingCount<a&&(O.pingForSmartLogin(o,t,n),LoginRadiusDefaults.pingCount++)},1e3*i):e.ErrorCode&&1139!==e.ErrorCode?(n(e),LoginRadiusDefaults.pingCount=0):(LoginRadiusDefaults.pingCount=0,t(e))},"pingSmartLogin")},O.addChangeEventHandler=function(c,e,o,u){D.util.addEvent("change",document.getElementById(u+"registration-"+e.name),function(e){D.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/"+o.DataSource+"?apiKey="+D.options.apiKey+"&parentId="+this.value,"",function(e,o){var t=document.getElementById(u+"registration-"+e.name);if(o.ErrorCode)for(var n=1;n<t.options.length;n++)t.options[n]=null;else for(var i=0;i<o.length;i++)if(0===i&&1<t.options.length){for(var a=1;a<t.options.length;a++)t.options[a]=null;var r=document.createElement("option");r.setAttribute("value",o[i].Id),r.appendChild(document.createTextNode(o[i].Key)),t.appendChild(r)}else{var s=document.createElement("option");s.setAttribute("value",o[i].Id),s.appendChild(document.createTextNode(o[i].Key)),t.appendChild(s)}for(var l=0;l<e.children.length;l++)O.addChangeEventHandler(c,e,e.children[l],u)},"registration",o)})},O.createFormFields=function(e,n,u,o,t,i,a){var p;a=a||function(){};function r(e){var o=Math.random(),t=this.value,n=D.util.elementById(u+"-password-strength-meter"),i=D.util.elementById(u+"-password-strength-text");i.innerHTML="";var a=0;0<t.length&&(a++,t.match(/[a-z]/)&&t.match(/[A-Z]/)&&a++,t.match(/\d+/)&&a++,t.match(/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/)&&a++,12<t.length&&a++),n.value=a;var r=document.getElementsByClassName(u+"-password");if(0<r.length)for(var s=0;s<r.length;s++)r[s].parentNode.removeChild(r[s]);var l=D.util.elementById(o)?D.util.elementById(o):document.createElement("style");l.type="text/css",l.id=o,l.setAttribute("class",u+"-password");var c=-1!==navigator.userAgent.indexOf("Firefox");l.innerHTML=c?"#"+u+"-password-strength-meter::-moz-meter-bar { background: "+p[a].color+" !important; }":"#"+u+"-password-strength-meter::-webkit-meter-optimum-value { background: "+p[a].color+" !important; }",document.body.appendChild(l),""!==t&&0<a?(i.innerHTML="Strength: "+p[a].Message,i.style.color=""):""!==t&&(i.innerHTML=p[a].Message,i.style.color=p[a].color)}function s(e){""!==this.value.trim()&&new LoginRadiusControllers(D,O).checkPhoneNumberAvailabilityController("phone="+this.value,function(e){if(e.IsExist)for(var o=0;o<n.childNodes.length;o++)-1!==n.childNodes[o].getAttribute("class").indexOf("phoneid")&&(n.childNodes[o].childNodes[2].innerHTML="phone already exists, enter unique phone number");else for(var t=0;t<n.childNodes.length;t++)-1!==n.childNodes[t].getAttribute("class").indexOf("phoneid")&&(n.childNodes[t].childNodes[2].innerHTML="")},a)}for(var l=0;l<e.length;l++)if(e[l]){var c;switch(O.setValidation(e[l]),e[l].rules&&""!==e[l].rules&&-1<e[l].rules.indexOf("custom_validation")&&-1===e[l].rules.indexOf("callback_custom_validation")&&(e[l].rules=e[l].rules.replace(/custom_validation\b/g,"callback_custom_validation")),o[l]={},o[l].name=e[l].name,o[l].display=e[l].display,o[l].rules=e[l].rules,e[l].type){case"text":c=document.createElement("textarea");break;case"html":case"captcha":c=document.createElement("div");break;case"password":(c=document.createElement("input")).type="password";break;case"hidden":(c=document.createElement("input")).type="hidden",c.value=e[l].value||"";break;case"option":c=document.createElement("select");var d=document.createElement("option");if(d.appendChild(document.createTextNode("-- select --")),d.setAttribute("value",""),c.appendChild(d),null==e[l].DataSource&&null!=e[l].options){for(var m=0;m<e[l].options.length;m++){var g=document.createElement("option");g.setAttribute("value",e[l].options[m].value),"country"===e[l].name&&g.setAttribute("value",e[l].options[m].value+"|"+e[l].options[m].text),g.appendChild(document.createTextNode(e[l].options[m].text)),c.appendChild(g)}D.defaultOptionField[e[l].name]&&(c.value=D.defaultOptionField[e[l].name])}break;case"multi":(c=document.createElement("input")).type="checkbox";break;case"email":(c=document.createElement("input")).type="email";break;case"button":(c=document.createElement("input")).type="button",c.value=e[l].display;break;case"image":(c=document.createElement("img")).src=e[l].value,c.type="image";break;default:(c=document.createElement("input")).type="text"}if(e[l].title&&(c.title=e[l].title),e[l].disabled&&(c.disabled=e[l].disabled),O.setAttribute(e[l],c),e[l].placeholder&&(c.placeholder=e[l].placeholder),e[l].value&&("multi"===e[l].type?c.checked=!0:c.value=e[l].value),"html"===e[l].type){var f,h,v=document.createElement("div");if(v.setAttribute("class",t+"-form-element-content content-"+i+e[l].name),v.innerHTML=e[l].html,e[l].event&&D.util.addEvent(e[l].event,v,e[l].eventCallback),"consent"===e[l].name)for(f=v.getElementsByTagName("input"),h=0;h<f.length;h++)f[h].setAttribute("id",i+u+"-"+f[h].name);n.appendChild(v)}else if("captcha"===e[l].type){var y=document.createElement("div");if(y.setAttribute("class",t+"-form-element-content content-"+i+e[l].name),y.innerHTML=e[l].html,D.options.formValidationMessage){var C=document.createElement("div");C.setAttribute("id","validation-"+i+u+"-"+e[l].name),C.setAttribute("class",t+"validation-message validation-"+i+e[l].name),y.appendChild(C)}n.appendChild(y)}else{if(c.setAttribute("name",e[l].name),e[l].name&&("phoneid"===e[l].name.toLowerCase()||"phone"===e[l].name.toLowerCase())&&D.options.existPhoneNumber&&"registration"===u&&D.util.addEvent("blur",c,s),"emailid"===e[l].name&&D.util.addEvent("keyup",c,function(e){32===e.keyCode&&(this.value=this.value.trim())}),c.setAttribute("id",i+u+"-"+e[l].name),e[l].event&&D.util.addEvent(e[l].event,c,e[l].eventCallback),D.eventsName[c.id]){var w=D.eventsName[c.id];if(D.util.isArray(w))for(var k=0;k<w.length;k++)w[k].event&&w[k].eventCallback&&D.util.addEvent(w[k].event,c,w[k].eventCallback);else D.util.addEvent(w.event,c,w.eventCallback)}if("hidden"===e[l].type)n.appendChild(c);else if("button"===e[l].type){var T=document.createElement("div");T.setAttribute("class",t+"-form-element-content content-"+i+e[l].name),T.appendChild(c),n.appendChild(T)}else{var L=document.createElement("label");L.setAttribute("for",i+u+"-"+e[l].name),L.innerHTML=e[l].display,c.setAttribute("class",t+e[l].type+" "+i+e[l].name),e[l].rules&&-1!==e[l].rules.indexOf("required")&&(c.className+=" lr-required");var S=document.createElement("div");if(S.setAttribute("class",t+"-form-element-content content-"+i+e[l].name),"multi"===e[l].type?(S.appendChild(c),S.appendChild(L)):(S.appendChild(L),S.appendChild(c)),e[l].style&&0<e[l].style.length)for(var P=0;P<e[l].style.length;P++)S.style[e[l].style[P].key]=e[l].style[P].value;if(D.options.formValidationMessage){var R=document.createElement("div");R.setAttribute("id","validation-"+i+u+"-"+e[l].name),R.setAttribute("class",t+"validation-message validation-"+i+e[l].name),S.appendChild(R)}if(D.options.displayPasswordStrength&&("password"===c.name||"newpassword"===c.name)&&("registration"===u||"resetpassword"===u||"setpassword"===u||"changepassword"===u||"socialRegistration"===u||"loginRequiredFieldsUpdate"===u)){D.options.passwordLength&&D.options.passwordLength.min,D.options.passwordLength&&D.options.passwordLength.max;if(e[l].rules)for(var b=e[l].rules.split("|"),E=0;E<b.length;E++)-1<b[E].indexOf("min_length")?b[E].substring(11,b[E].length-1):-1<b[E].indexOf("max_length")&&b[E].substring(11,b[E].length-1);var I=document.createElement("meter");I.setAttribute("max","4"),I.setAttribute("id",u+"-password-strength-meter");var A=document.createElement("div");A.setAttribute("id",u+"-password-strength-text"),c.parentNode.appendChild(I),c.parentNode.appendChild(A),p=F(),D.util.addEvent("keyup",c,r)}n.appendChild(S)}}}},O.setToken=function(e){LRNameSpace.cookies.setItem(LoginRadiusDefaults.tokenCookie,e,"",D.options.appPath)},O.resetGoogleCaptcha=function(e,o){if(D.options.optionalRecaptchaConfiguration.IsEnabled&&"registration"!==e){var t=D.util.elementById(o,!0);window.grecaptcha&&t&&""!==t.innerHTML&&grecaptcha.reset(window[o+"lr_recaptcha_widgets_idprefix"])}},O.createForm=function(e,u,o,p,d,m){var t,n,i,g=m||LoginRadiusDefaults.idPrefix,f=m||LoginRadiusDefaults.classPrefix;if(D.LRPrefix=m+"##"+LoginRadiusDefaults.idPrefix,"Captcha"===D.options.loginLockedType&&"registration"!==u||D.options.optionalRecaptchaConfiguration.IsEnabled){var a=D.options.optionalRecaptchaConfiguration.Apis;("Captcha"===D.options.loginLockedType||a&&(n=a,"changepassword"===(i=u.toLowerCase())&&n.PutChangePassword||("profileeditor"===i||"loginRequiredFieldsUpdate"===i||"progressiveProfiling"===i||"socialRegistration"===i)&&n.PutUpdateProfile||"forgotpassword"===i&&(D.options.phoneLogin&&n.PostForgotPasswordByPhone&&n.PostForgotPasswordByEmail||!D.options.phoneLogin&&n.PostForgotPasswordByEmail)||"login"===i&&(D.options.usernameLogin&&n.PostLoginByUserNameAndPassword&&D.options.phoneLogin&&n.PostLoginByEmailAndPassword&&n.PostLoginByPhoneAndPassword||D.options.phoneLogin&&n.PostLoginByEmailAndPassword&&n.PostLoginByPhoneAndPassword||!D.options.phoneLogin&&D.options.usernameLogin&&n.PostLoginByUserNameAndPassword||!D.options.usernameLogin&&!D.options.phoneLogin&&n.PostLoginByEmailAndPassword)))&&(t=m+LoginRadiusDefaults.idPrefix+"recaptcha_widget_"+u.toLowerCase(),D.util.addRecaptchaJS(),D.util.captchaSchema(t,e))}if(D.$hooks.call("beforeFormRender",u,e),LoginRadiusDefaults._uuidFormat.test(D.options.apiKey)){if(LoginRadiusDefaults.isRegFormSchemaLock=!1,LoginRadiusDefaults.isSecurityFormSchemaLock=!1,O.setCustomLabel(e),O.setPlaceholder(e),O.setCustomTitle(e),0<e.length){var r=[],h=document.createElement("form");h.setAttribute("name",g+u),h.setAttribute("method","POST"),O.createFormFields(e,h,u,r,f,g,d);var s,l=document.createElement("input"),c=D.buttonsName[u.toLowerCase()]||k[u.toLowerCase()],v=k[u.toLowerCase()].toLowerCase().replace(/ /g,"-");if(l.type="submit",D.options.isPINAuthentication&&"loginRequiredFieldsUpdate"===u&&D.util.findInSchema(e,"name","pin")?l.value="Continue":l.value=c,l.id=g+"submit-"+v,l.setAttribute("class",f+"submit submit-"+g+v),D.options.disableButtonOnsubmit)D.$hooks.register("eventCalls",function(e){window.lrpasswordlessloginotp||window.lrpasswordlesslogin||(s=e)}),D.$hooks.register("startProcess",function(e){s===u&&(l.disabled=!0)}),D.$hooks.register("xhrEndWithError",function(e){s===u&&(l.disabled=!1)}),D.$hooks.register("xhrEndWithSuccess",function(e){s===u&&D.options.enableSubmitOnSuccess&&(l.disabled=!1)});h.appendChild(l),D.options.passwordlessLogin&&"login"===u&&L("passwordlessloginbuttonlabel",h,l,g,f),D.options.passwordlessLoginOTP&&"login"===u&&L("passwordlessLoginOTPButtonLabel",h,l,g,f),D.util.addHTMLContent(o,h,LoginRadiusDefaults.innerHTML),D.$hooks.call("afterFormRender",u,o,f,h),LoginRadiusDefaults.innerHTML=!1;var y,C=new FormValidator(g+u,r,function(e,o){var t=document.getElementsByTagName("form"),n="";if(t[g+u])n=t[g+u];else if("object"==typeof t)for(var i=0;i<t.length;i++)if(t[i].name===g+u){n=t[i];break}D.currentLRContainer=n.parentElement.id,D.$hooks.call("eventCalls",u,f),D.mergeFormErrors&&0<D.mergeFormErrors.length&&(e=D.util.mergeObjects(e,D.mergeFormErrors));for(var a=D.util.elementsByClass(f+"validation-message"),r=0;r<a.length;r++)a[r].innerHTML="";var s=m+g+"recaptcha_widget";s+="_"+u.toLowerCase();var l=D.util.elementById(s+"_tencent");if(D.options.invisibleRecaptcha&&(window.onCaptchaSubmit=function(e){p(D.util.serialize(h)),grecaptcha.reset(window[s+"lr_recaptcha_widgets_idprefix"])}),l&&"none"!==l.style.display&&(D.options.tencentCaptcha||D.options.tencentCaptchaAsFallback&&!window.grecaptcha)&&0==e.length&&l.click(),0<e.length){D.$hooks.call("afterValidation",u);for(var c=0;c<e.length;c++)if(e[c].Id===g+""+u+"-password"&&"login"===u&&(D.options.passwordlessLogin&&window.lrpasswordlesslogin||D.options.passwordlessLoginOTP&&window.lrpasswordlessloginotp)){if(1===e.length||0===e.length)return T(h,p,s),O.resetGoogleCaptcha(u,s),!0}else D.options.formValidationMessage&&"resettoken"!==e[c].Name&&(D.util.elementById("validation-"+g+u+"-"+e[c].Name).innerHTML=e[c].Message);D.options.formValidationMessage||(d(e),O.resetGoogleCaptcha(u,s))}else T(h,p,s),O.resetGoogleCaptcha(u,s);o&&o.preventDefault?o.preventDefault():event&&(event.returnValue=!1)});if(D.validationMessages&&0<D.validationMessages.length)for(var w=0;w<D.validationMessages.length;w++)C.setMessage(D.validationMessages[w].rule,D.validationMessages[w].message),"valid_date"!==D.validationMessages[w].rule&&"callback_valid_date"!==D.validationMessages[w].rule||(y=D.validationMessages[w].message);C.registerCallback("valid_date",function(e){return function(e){var o=e.split("/");-1!==e.indexOf("-")&&(o=e.split("-"));var t=parseInt(o[1],10),n=parseInt(o[0],10),i=parseInt(o[2],10);if(i<1e3||3e3<i||0===n||12<n)return!1;var a=[31,28,31,30,31,30,31,31,30,31,30,31];return(i%400==0||i%100!=0&&i%4==0)&&(a[1]=29),0<t&&t<=a[n-1]}(e)}).setMessage("valid_date",y||"The %s field must contain a valid date."),C.registerCallback("custom_validation",function(e,o){return function(e,o){o=(o=o.split("###")[0]).split("or").join("|");try{return new RegExp(o,"g").test(e)?!0:!1}catch(e){return D.log("Invalid custom validation regex expression"),!1}}(e,o)}).setMessage("custom_validation","The %s field is not valid."),D.Validator=C}}else D.log("apiKey is not in valid guid format.");D.options.optionalRecaptchaConfiguration.IsEnabled&&"registration"!==u&&D.util.renderV2Recaptcha(t,!0)},O.createConsentInterface=function(e,o){var t="";if(e){for(var n=0;n<e.ConsentForm.length;n++)if("Group"===e.ConsentForm[n].Type){if(e.ConsentForm[n].Consents.length){var i={consentGroupTitle:e.ConsentForm[n].Title,consentGroupDescription:e.ConsentForm[n].Description};t+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentGroupTemplate,i);for(var a=0;a<e.ConsentForm[n].Consents.length;a++){var r={consentTitle:e.ConsentForm[n].Consents[a].Title,consentDescription:e.ConsentForm[n].Consents[a].Description,consentId:"consent_"+e.ConsentForm[n].Consents[a].ConsentId};t+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,r)}}}else if("Consent"===e.ConsentForm[n].Type)for(a=0;a<e.ConsentForm[n].Consents.length;a++){r={consentTitle:e.ConsentForm[n].Consents[a].Title,consentDescription:e.ConsentForm[n].Consents[a].Description,consentId:"consent_"+e.ConsentForm[n].Consents[a].ConsentId};t+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,r)}t+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentMainTemplate,e);var s=document.getElementById(LoginRadiusDefaults.templates.consentGroupTemplate);s&&s.remove();var l=document.getElementById(LoginRadiusDefaults.templates.consentOptionTemplate);if(l&&l.remove(),o){var c=document.createElement("div");c.innerHTML=t.trim();for(var u=0;u<o.length;u++){var p=c.querySelector('input[name="consent_'+o[u].ConsentOptionId+'"]');p&&p.setAttribute("checked","checked")}t=c.innerHTML?c.innerHTML:""}}return t},O.createConsentOptionInterface=function(e,o){var t="";if(e){for(var n in e){var i={consentTitle:e[n].Title,consentDescription:e[n].Description,consentId:"consent_"+e[n].ConsentId,checked:!!e[n].checked};t+=D.util.hashTmpl(LoginRadiusDefaults.templates.consentOptionTemplate,i)}var a=document.createElement("div");a.innerHTML=t.trim();for(var r=0;r<o.length;r++){if(e[o[r].ConsentOptionId])a.querySelector('input[name="consent_'+o[r].ConsentOptionId+'"]').setAttribute("checked","checked")}}return t=a.innerHTML?a.innerHTML:""},O.setConsentTemplate=function(){var e=document.getElementById(LoginRadiusDefaults.templates.consentMainTemplate);if(e){var o=document.createElement("div");o.innerHTML=e.innerHTML,e.append(o);var t=document.createElement("script");t.type="text/html",t.id=LoginRadiusDefaults.templates.consentOptionTemplate,t.innerHTML=this.decodeHtml(document.getElementById(LoginRadiusDefaults.templates.consentOptionTemplate).innerHTML);var n=document.getElementById(LoginRadiusDefaults.templates.consentGroupTemplate);if(n){var i=n.querySelectorAll("#"+LoginRadiusDefaults.templates.consentOptionTemplate)[0];i&&i.remove()}var a=document.createElement("script");a.type="text/html",a.id=LoginRadiusDefaults.templates.consentGroupTemplate,a.innerHTML=this.decodeHtml(n.innerHTML),n.remove(),e.innerHTML=this.decodeHtml(o.innerHTML),o.remove(),document.body.append(a),document.body.append(t)}},O.consentValidation=function(e,o){var t=D.util.parseQueryString(e),n=[];if(o){if(D.consentOptions[o]&&D.consentOptions[o].ConsentForm)for(var i=D.consentOptions[o].ConsentForm,a=0;a<i.length;a++){var r=i[a];n="Group"===r.Type?O.setConsentValidation(r,t,n,!0):O.setConsentValidation(r,t,n)}}else{var s={Type:"Consent",Consents:[]};for(var l in D.consentsList)s.Consents.push(D.consentsList[l]);n=O.setConsentValidation(s,t,n)}return n},O.setConsentValidation=function(e,o,t,n){var i=!1;if(n&&e.IsRequiredAtleastOne&&0===e.Consents.length)t.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group should have at least one consent"});else{for(var a=0;a<e.Consents.length;a++)n&&e.IsRequiredAtleastOne&&"true"===o["consent_"+e.Consents[a].ConsentId]&&(i=!0),e.Consents[a].IsRequired&&"true"!==o["consent_"+e.Consents[a].ConsentId]&&t.push({Id:e.Consents[a].ConsentId,Name:e.Consents[a].Title,Message:e.Consents[a].Title+" consent is required"});e.IsRequiredAtleastOne&&!i&&t.push({Id:e.GroupId,Name:e.Title,Message:"In "+e.Title+" group at least one consent is required"})}return t},O.isValidToken=function(e,o){return!!e||(o([O.setMappedMessage(A.tokenValid)]),!1)},O.decodeHtml=function(e){var o=document.createElement("textarea");return o.innerHTML=e,o.value},O.checkForLatestPrivacyPolicy=function(e){for(var o=D.options.privacyPolicyConfiguration.PrivacyPolicies,t=(new Date).getTime(),n={},i=0;i<o.length;i++)new Date(o[i].StartDateTime).getTime()<t&&(D.util.isEmpty(n)||!D.util.isEmpty(n)&&new Date(n.StartDateTime).getTime()<new Date(o[i].StartDateTime).getTime())&&(n=o[i]);return n.Version===e.PrivacyPolicy.Version},O.sanitizePinData=function(e){var o=Object.assign({},e),t={PIN:"",Skipped:null};return o.hasOwnProperty("pin")&&o.pin?t.PIN=o.pin:t.Skipped=!0,delete o.pin,o.PINInfo=t,o},O.sanitizeSecurityQuesData=function(e){var o=D.util.parseQueryString(e),t={},n=["email","username","phone","password","pin","phoneApi"];for(var i in o)-1===n.indexOf(i)&&(t[i]=o[i],delete o[i]);return o.securityanswer=t,o}}function LoginRadiusControllers(w,k){var T=LoginRadiusDefaults.messages,L=this;function i(e,o,t,n,i){o?w.util.ajaxCall(e,LoginRadiusDefaults.apiDomain+"/auth/customobject/"+t+"?apiKey="+w.options.apiKey+"&access_token="+o+"&objectname="+w.options.customObjectName,"",function(e){e.ErrorCode?i(k.loginRadiusErrorTojsError(e)):n(e)},"CustomObject"):i([k.setMappedMessage(T.twofaTokenValid)])}L.handleFeatures=function(e,o,t,n,i,a,r){var s,l,c,u,p,d,m,g,f=e.Profile;"string"!=typeof o&&(o=w.util.jsonToQueryString(o)),n&&w.options.periodicPasswordReset&&f.PasswordExpirationDate&&new Date(f.PasswordExpirationDate)<=new Date?(k.setPasswordRule(w.changePasswordFormSchema[1]),k.setPasswordRule(w.changePasswordFormSchema[2]),n(f,e)):t&&(w.options.askRequiredFieldForTraditionalLogin||LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin||w.askPinOnLogin)?(s=f,l=e,c=o,u=t,p=i,d=a,w.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,l.access_token),w.options.isPINAuthentication&&w.options.PINConfiguration.PINLogin&&l&&l.session_token&&w.setSessionToken(l),m=w.options,g=(g=JSON.parse(JSON.stringify(m))).RegistrationFormSchema,s.IsDeleted?d(k.loginRadiusErrorTojsError(s)):(w.options.autoFilledFieldForTraditional&&w.$hooks.register("beforeFormRender",function(e,o){if("loginRequiredFieldsUpdate"===e){var t=w.util.findInSchema(o,"name","emailid");t&&t.value&&(t.disabled=!0);var n=w.util.findInSchema(o,"name","phoneid");n&&n.value&&(n.disabled=!0)}}),w.registrationFormSchema=k.mapSchema(g,s,w.options.autoFilledFieldForTraditional),0<w.registrationFormSchema.length?(k.setPasswordRule(w.util.findInSchema(g,"name","password")),k.setPasswordRule(w.util.findInSchema(g,"name","confirmpassword")),w.$hooks.call("registrationSchemaFilter",g,s),u(s,l,l.access_token,c,p,d)):k.loginHandleToken(l,c,p,d))):k.loginHandleToken(e,o,i,a,r)},L.verifyOTPController=function(o,e,t,n,i,a){var r=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+w.options.apiKey+"&otp="+o.otp+"&smsTemplate="+w.options.smsTemplateWelcome;o.haveToken&&(r+="&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName)),o.onetouchloginflag&&(r=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone/verify?apiKey="+w.options.apiKey+"&otp="+o.otp+"&smsTemplate="+w.options.smsTemplateOneTouchLoginWelcome),w.util.ajaxCall("put",r,e,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):o.onetouchloginflag&&!w.options.askRequiredFieldsOnPasswordLessLogin?k.loginHandleToken(e,"",t,n,"",!0):e.access_token?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,L.handleFeatures(e,o,a,i,t,n)):t(e,o)},"verifyOTP")},L.updateSecurityQuestionController=function(e,o,t){for(var n=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i=w.util.parseQueryString(e),a=0;a<w.options.securityQuestionsCount;a++)i[i["securityQuestion"+a]]=i["securityAnswer"+a],delete i["securityQuestion"+a],delete i["securityAnswer"+a];var r={SecurityQuestionAnswer:i};k.isValidToken(n,t)&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apikey="+w.options.apiKey+"&access_token="+n,r,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"updateSecurityQuestion")},L.resetTwoFactorAuthenticationController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),i={};i[o]=!0,k.isValidToken(e,n)&&w.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/authenticator?apikey="+w.options.apiKey+"&access_token="+e,i,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,o)},"resetTwoFactorAuthentication")},L.forgotPasswordController=function(t,n,i,a,r){var e=w.options.forgotPasswordUrl||w.options.resetPasswordUrl;w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password?apiKey="+w.options.apiKey+"&resetPasswordUrl="+e+"&emailTemplate="+w.options.resetPasswordEmailTemplate,t,function(e){if(e.ErrorCode)a(k.loginRadiusErrorTojsError(e));else{var o=w.util.parseQueryString(t);i(e,o),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&k.resetPassword(n,i,a,r,o)}},"forgotPassword")},L.forgotPINController=function(t,n,i,a,r){var e=w.util.parseQueryString(t).hasOwnProperty("username")?"username":"email",o=w.options.forgotPINUrl||w.options.resetPINUrl;w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/"+e+"?apiKey="+w.options.apiKey+"&resetPINUrl="+o+"&emailTemplate="+w.options.resetPINEmailTemplate,t,function(e){if(e.ErrorCode)a(k.loginRadiusErrorTojsError(e));else{var o=w.util.parseQueryString(t);i(e,o),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&k.resetPIN(n,i,a,r,o)}},"forgotPIN")},L.loginController=function(t,n,i,a,r,s,l,c,u){w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate;var e="emailTemplate="+w.options.verificationEmailTemplate+"&verificationUrl="+w.options.verificationUrl;w.options.phoneLogin&&(e+="&smsTemplate="+w.options.smsTemplatePhoneVerification),w.options.riskBasedAuthentication&&(e+="&RbaOneclickEmailTemplate="+w.options.rbaOneclickEmailTemplate+"&RbaOTPSmsTemplate="+w.options.rbaOTPSmsTemplate+"&RbaCityEmailTemplate="+w.options.rbaCityEmailTemplate+"&RbaCountryEmailTemplate="+w.options.rbaCountryEmailTemplate+"&RbaBrowserEmailTemplate="+w.options.rbaBrowserEmailTemplate+"&RbaIpEmailTemplate="+w.options.rbaIpEmailTemplate+"&RbaCitySmsTemplate="+w.options.rbaCitySmsTemplate+"&RbaCountrySmsTemplate="+w.options.rbaCountrySmsTemplate,e+="&RbaBrowserSmsTemplate="+w.options.rbaBrowserSmsTemplate+"&RbaIpSmsTemplate="+w.options.rbaIpSmsTemplate),("string"==typeof(t=w.util.checkPhoneOrEmailLogin(t))||t instanceof String)&&(t=w.util.parseQueryString(t)),w.options.duplicateEmailWithUniqueUsername&&(delete t.email,delete t.phoneid);var o=LoginRadiusDefaults.apiDomain+"/auth/login?apiKey="+w.options.apiKey+"&loginUrl="+w.options.loginUrl+"&"+e;t["g-recaptcha-response"]&&(o+="&g-recaptcha-response="+t["g-recaptcha-response"],delete t["g-recaptcha-response"]),t.qq_captcha_randstr&&(o+="&qq_captcha_randstr="+t.qq_captcha_randstr,delete t.qq_captcha_randstr),t.qq_captcha_ticket&&(o+="&qq_captcha_ticket="+t.qq_captcha_ticket,delete t.qq_captcha_ticket),w.util.ajaxCall("post",o,t,function(e){if(w.options.stayLogin&&w.storage.setBrowserStorage("lr-rememberme",t.stayLogin),e.ErrorCode)"970"==e.ErrorCode&&w.options.otpEmailVerification&&!w.options.verifyEmailByOTP?k.otpEmailVerification(n,i,a,l,t):"1167"==e.ErrorCode&&(e.PhoneId||t.phone)?(delete t.email,t.phone=e.PhoneId||t.phone,L.loginOTPController(t,n,i,a,l,"no")):w.options.phoneLogin&&"1066"==e.ErrorCode&&(k.verifyOTP=c||k.verifyOTP,k.resendOTP=u||k.resendOTP,k.verifyOTP(t,n,i,a,l,r,s),k.resendOTP(t,n,i,a,l,r,s)),a(k.loginRadiusErrorTojsError(e));else{w.askPinOnLogin=!1;var o=e.Profile;w.options.isPINAuthentication&&o&&(w.options.PINConfiguration.AskOnlyOnFirstLogin&&o.FirstLogin||w.options.PINConfiguration.AskOnLogin)&&(null!==o.PIN&&o.PIN.PIN||(w.askPinOnLogin=!0)),L.handleFeatures(e,t,s,r,i,a,l)}},"login")},L.loginOTPController=function(t,n,i,a,r,e){var s=t=w.util.checkPhoneOrEmailLogin(t);if(("string"==typeof t||t instanceof String)&&(s=w.util.parseQueryString(t)),s.email||s.username)k.sendInstantSignInLink(t,i,a,n,r);else{w.$hooks.register("beforeFormRender",function(e,o){w.util.findInSchema(o,"name","resendotp")||o.push({type:"button",name:"resendotp",display:"Resend OTP",rules:"",permission:"r",event:"click",eventCallback:function(e){L.loginOTPController(t,n,i,a,r)}})});function o(){var e=w.otpSchema;k.createForm(e,"otp",n,function(e){var o=r+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";L.verifyInstantOTP(e,s,i,a,o,n,r)},function(e){a(k.setMappedMessage(e))},r)}if(e)o();else{var l=w.options.smsTemplateInstantOTPLogin||w.options.passwordlessLoginSMSTemplate;w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/otp?apiKey="+w.options.apiKey+"&phone="+s.phone+"&smsTemplate="+l,"",function(e){e.ErrorCode?a(k.loginRadiusErrorTojsError(e)):(i(e),o())},"loginOTP")}}},L.loginPINController=function(o,e,t,n,i,a,r,s){w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate,("string"==typeof o||o instanceof String)&&(o=w.util.parseQueryString(o));var l=LoginRadiusDefaults.apiDomain+"/auth/login/pin?apiKey="+w.options.apiKey+"&session_token="+s;w.util.ajaxCall("post",l,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):L.handleFeatures(e,o,r,a,t,n,i)},"login")},L.login2FAController=function(t,c,u,p,d,m,g,a,r,s){w.LRCheck2FA=!0,t=w.util.checkPhoneOrEmailLogin(t);var f=function(l,e,o){e=e||"",o=o||"";var t=w.util.getButtonAttribute("sendotp",d);if(w.options.googleAuthentication&&(!e&&w.options.twoFactorAuthentication||o)&&k.showQRCode(l,c,u,p,d,m,g),e||o||!w.options.twoFactorAuthentication){if(!o&&w.options.twoFactorAuthentication||w.options.optionalTwoFactorAuthentication&&!e&&""!==l.SecondFactorAuthentication.OTPPhoneNo&&null!=l.SecondFactorAuthentication.OTPPhoneNo||e)if(o)if(d=d||LoginRadiusDefaults.classPrefix,w.options.googleAuthentication){var n=document.getElementsByName(d+"showQRcode")[0];n&&n.appendChild(t)}else w.util.addHTMLContent(c,t);else k.verifyOTP=r||k.verifyOTP,k.resendOTP=s||k.resendOTP,k.verifyOTP(l,c,u,p,d,m,g),k.resendOTP(l,c,u,p,d,m,g)}else k.updatePhoneNumber=a||k.updatePhoneNumber,k.updatePhoneNumber(c,u,p,d,"",m,g);if(e||o){var i=w.util.getButtonAttribute("backupcodebutton",d);w.util.addHTMLContent(c,i,!0),w.util.addEvent("click",i,function(e){var o,t,n,i,a,r;o=c,t=u,n=p,i=d,a=m,r=g,k.createForm(w.backupCodeFormSchema,"backupcode",o,function(e){L.backupCodeController(e,t,n,a,r)},function(e){n(e)},i);var s=w.util.getButtonAttribute("backupcodebackbutton",d);w.util.addHTMLContent(c,s,!0),w.util.addEvent("click",s,function(e){f(l,l.SecondFactorAuthentication.IsOTPAuthenticatorVerified,l.SecondFactorAuthentication.IsGoogleAuthenticatorVerified)})})}w.util.addEvent("click",t,function(e){var o="phoneNo2FA="+l.SecondFactorAuthentication.OTPPhoneNo;k.resendOTPManually(o,c,u,p,d,m,g),k.verifyOTP=r||k.verifyOTP,k.resendOTP=s||k.resendOTP,k.verifyOTP(l,c,u,p,d,m,g),k.resendOTP(l,c,u,p,d,m,g)})},e=LoginRadiusDefaults.apiDomain+"/auth/login/2FA/";w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate;var o,n="post";o=window.lrbackupcode?(e=e+"backupcode?apiKey="+w.options.apiKey+"&"+t,n="get",""):(e=e+"?apiKey="+w.options.apiKey+"&loginUrl="+w.options.loginUrl+"&emailTemplate="+w.options.verificationEmailTemplate+"&verificationUrl="+w.options.verificationUrl+"&smsTemplate="+w.options.smsTemplateWelcome+"&smsTemplate2FA="+w.options.smsTemplate2FA,w.util.parseQueryString(t)),w.util.ajaxCall(n,e,o,function(e){if(w.options.stayLogin&&w.storage.setBrowserStorage("lr-rememberme",w.util.getQueryParameterByName("stayLogin",t)),e.ErrorCode){if(w.options.phoneLogin&&"1066"==e.ErrorCode){var o="phone="+w.util.getQueryParameterByName("phone",t);o+="&noPhoneVerified=false",w.options.optionalTwoFactorAuthentication=!1,w.options.twoFactorAuthentication=!1,k.verifyOTP=r||k.verifyOTP,k.resendOTP=s||k.resendOTP,k.verifyOTP(o,c,u,p,d,m,g),k.resendOTP(o,c,u,p,d,m,g)}p(k.loginRadiusErrorTojsError(e))}else e.SecondFactorAuthentication?(w.storage.setBrowserStorage(LoginRadiusDefaults.storedTwoFAToken,e.SecondFactorAuthentication.SecondFactorAuthenticationToken),w.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,e.SecondFactorAuthentication.IsOTPAuthenticatorVerified),"00000000-0000-0000-0000-000000000000"===e.access_token&&f(e,e.SecondFactorAuthentication.IsOTPAuthenticatorVerified,e.SecondFactorAuthentication.IsGoogleAuthenticatorVerified)):L.handleFeatures(e,t,g,m,u,p,d)},"login")},L.resendOTPController=function(e,o,t,n,i,a){var r=e.updatePhone?w.options.smsTemplateUpdatePhone:w.options.smsTemplatePhoneVerification,s=LoginRadiusDefaults.apiDomain+"/auth/phone/otp?apiKey="+w.options.apiKey+"&smsTemplate="+r,l="post";e.onetouchloginflag&&(l="get","string"!=typeof e&&(e=w.util.jsonToQueryString(e)),s=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+w.options.apiKey+"&"+e+"&smstemplate="+w.options.smsTemplatePhoneVerification),w.util.ajaxCall(l,s,e,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):(w.log(T.otpSent),o(e))},"resendOTP")},L.resendOTP2FAController=function(e,o,t,n,i,a){var r=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),s=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);s&&!w.LRCheckLogin?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+w.options.apiKey+"&access_token="+s+"&smsTemplate="+w.options.smsTemplate2FA,e,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):(w.log(T.otpSent),o(e))},"resendOTP"):r?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/resend?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+r+"&smsTemplate2FA="+w.options.smsTemplate2FA,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):w.log(T.otpSent)},"resendOTP"):t([k.setMappedMessage(T.twofaTokenValid)])},L.verify2FAOTPController=function(o,t,n,i,a){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),r=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken);e&&!w.LRCheckLogin?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/Verification?apiKey="+w.options.apiKey+"&access_token="+e+"&"+o+"&smsTemplate="+w.options.smsTemplate2FAWelcome,"",function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,o)},"verifyOTP##twofaotp"):r?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/Verification?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+r+"&"+o+"&smsTemplate2FA="+w.options.smsTemplate2FAWelcome,"",function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):L.handleFeatures(e,o,a,i,t,n)},"verifyOTP##twofaotp"):n([k.setMappedMessage(T.twofaTokenValid)])},L.backupCodeController=function(o,t,n,i,a){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken);e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/backupcode?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&"+o+"&smsTemplate2FA="+w.options.smsTemplate2FAWelcome,"",function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):L.handleFeatures(e,o,a,i,t,n)},"login"):n([k.setMappedMessage(T.twofaTokenValid)])},L.checkPhoneNumberAvailabilityController=function(e,o,t){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"checkPhone")},L.update2FAPhoneNumberController=function(o,t,n,i,a,r,s,l,c){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTwoFAToken),u=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);u&&!w.LRCheckLogin?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apiKey="+w.options.apiKey+"&access_token="+u+"&smsTemplate="+w.options.smsTemplate2FA,o,function(e){e.ErrorCode?i(k.loginRadiusErrorTojsError(e)):(k.verifyOTP=l||k.verifyOTP,k.resendOTP=c||k.resendOTP,k.verifyOTP(o,t,n,i,a,r,s),k.resendOTP(o,t,n,i,a,r,s),n(e,o))},"updatePhone"):e?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/2FA/?apiKey="+w.options.apiKey+"&SecondFactorAuthenticationToken="+e+"&smsTemplate2FA="+w.options.smsTemplate2FA,o,function(e){e.ErrorCode?i(k.loginRadiusErrorTojsError(e)):(n(e,o),k.verifyOTP=l||k.verifyOTP,k.resendOTP=c||k.resendOTP,k.verifyOTP(o,t,n,i,a,r,s),k.resendOTP(o,t,n,i,a,r,s))},"login"):i([k.setMappedMessage(T.twofaTokenValid)])},L.updatePhoneNumberController=function(o,t,n,i,a,r,s,l,c){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);k.isValidToken(e,i)&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/phone?apiKey="+w.options.apiKey+"&access_token="+e+"&smsTemplate="+w.options.smsTemplateUpdatePhone,o,function(e){e.ErrorCode?i(k.loginRadiusErrorTojsError(e)):(k.verifyOTP=l||k.verifyOTP,k.resendOTP=c||k.resendOTP,k.verifyOTP(o+"&haveToken=true",t,n,i,a,r,s),k.resendOTP(o+"&updatePhone=true",t,n,i,a,r,s),n(e,o))},"updatePhone")},L.resetPasswordByPhoneController=function(o,t,n,e,i){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateWelcome,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,o)},"resetPassword")},L.resetPINByPhoneController=function(o,t,n,e,i){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/phone?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateWelcome,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,o)},"resetPIN")},L.forgotPasswordbyPhoneController=function(o,t,n,i,a,r){w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/password/otp?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateForgot,o,function(e){e.ErrorCode?i(k.loginRadiusErrorTojsError(e)):(n(e,o),(r||k.resetPassword)(t,n,i,a))},"forgotPassword")},L.forgotPINbyPhoneController=function(o,t,n,i,a,r){w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/pin/forgot/otp?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateForgot,o,function(e){e.ErrorCode?i(k.loginRadiusErrorTojsError(e)):(n(e,o),(r||k.resetPIN)(t,n,i,a))},"forgotPIN")},L.registrationController=function(n,i,a,r,s,e,l,c){w.LRCheckRegistration=!0;var o=n;w.lrApiFramework||(o=k.mapRegistrationSchema(e,n));var t="emailTemplate="+w.options.verificationEmailTemplate+"&verificationUrl="+w.options.verificationUrl+"&welcomeEmailTemplate="+w.options.welcomeEmailTemplate;w.options.phoneLogin&&(t+="&smsTemplate="+w.options.smsTemplatePhoneVerification),w.options.preventVerificationEmail&&(t+="&options=PreventVerificationEmail");var u="";w.options.invisibleRecaptcha||w.options.v2Recaptcha||w.options.tencentCaptcha?u=LoginRadiusDefaults.apiDomain+"/auth/register/captcha?apiKey="+w.options.apiKey+"&"+t:w.options.sott?(u=LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+w.options.apiKey+"&"+t,w.options.enableHeaderSott?(w.options.sott=decodeURIComponent(w.options.sott),o.sottcheck=!0):u+="&sott="+w.util.encodedString(w.options.sott)):w.log("url is not set as sott option is not defined"),""!==u&&w.util.ajaxCall("post",u,o,function(o){if(o&&w.util.isObject(o)&&(o=w.util.keyslowerToUpperCamelCase(o)),o.ErrorCode)1049===o.ErrorCode?(r([k.setMappedMessage(T.invalidSott)]),w.log(o.Description)):r(k.loginRadiusErrorTojsError(o));else{function t(e){e.push({type:"button",name:"skip",display:"Skip",rules:"",permission:"r",event:"click",eventCallback:function(e){k.loginHandleToken(o,n,a,r)}})}if(w.options.phoneLogin&&-1!==n.indexOf("phoneid")){-1===w.util.findInSchema(w.registrationFormSchema,"name","phoneid").rules.indexOf("required")&&w.$hooks.register("beforeFormRender",function(e,o){"otp"!==e||w.util.findInSchema(o,"name","skip")||t(o)}),k.verifyOTP=l||k.verifyOTP,k.resendOTP=c||k.resendOTP,k.verifyOTP(n,i,a,r,s),k.resendOTP(n,i,a,r,s)}else{var e=w.util.parseQueryString(n);if(w.options.disabledEmailVerification||w.options.optionalEmailVerification)if(o.Data&&(delete(o=o.Data).Data,delete o.IsPosted),w.options.askRequiredFieldForTraditionalLogin=!1,w.options.otpEmailVerification&&!w.options.verifyEmailByOTP){w.$hooks.register("beforeFormRender",function(e,o){"otp"!==e||w.util.findInSchema(o,"name","skip")||t(o)});k.otpEmailVerification(i,function(e){e.access_token||k.loginHandleToken(o,n,a,r)},r,s,e)}else k.loginHandleToken(o,n,a,r);else a(o,e),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&k.otpEmailVerification(i,a,r,s,e)}}},"registration")},L.periodicalPasswordRestController=function(e,o,t,n,i,a){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password?apiKey="+w.options.apiKey+"&access_token="+i.access_token,e,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):k.loginHandleToken(i,a,o,t)},"periodicPassword")},L.changePasswordController=function(o,t,n){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/change?apiKey="+w.options.apiKey+"&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"changePassword")},L.changePINController=function(o,t,n){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/change?apiKey="+w.options.apiKey+"&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"changePIN")},L.resendEmailVerificationController=function(o,t,n){w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/register?apiKey="+w.options.apiKey+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.verificationEmailTemplate,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"resendVerificationEmail")},L.addEmailController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);k.isValidToken(e,n)&&w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&access_token="+e+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.addEmailTemplate,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):(t(e,w.util.parseQueryString(o)),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&k.otpEmailVerification(w.currentLRContainer,t,n,"",o))},"addEmail")},L.removeEmailController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);k.isValidToken(e,n)&&w.util.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&access_token="+e,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):(t(e,w.util.parseQueryString(o)),w.options.otpEmailVerification&&!w.options.verifyEmailByOTP&&k.otpEmailVerification(w.currentLRContainer,t,n,"",o))},"removeEmail")},L.changeUsernameController=function(o,t,n){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);k.isValidToken(e,n)&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+w.options.apiKey+"&access_token="+e,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"changeUsername")},L.resetPasswordController=function(o,t,n,e,i){o+="&welcomeEmailTemplate="+w.options.welcomeEmailTemplate+"&ResetPasswordEmailTemplate="+w.options.resetPasswordConfirmationEmailTemplate,w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/reset?apiKey="+w.options.apiKey,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"resetPassword")},L.resetPINController=function(o,t,n,e,i){var a=w.util.parseQueryString(o),r="";if(a.hasOwnProperty("resettoken"))r=LoginRadiusDefaults.apiDomain+"/auth/pin/reset/token?apiKey="+w.options.apiKey;else{var s=a.hasOwnProperty("username")?"username":"email";r=LoginRadiusDefaults.apiDomain+"/auth/pin/reset/otp/"+s+"?apiKey="+w.options.apiKey}o+="&welcomeEmailTemplate="+w.options.welcomeEmailTemplate+"&ResetPINEmailTemplate="+w.options.resetPINConfirmationEmailTemplate,w.util.ajaxCall("put",r,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,w.util.parseQueryString(o))},"resetPIN")},L.emailVerificationController=function(e,o,t,n,i,a){var r="get";if(e){var s=LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&welcomeEmailTemplate="+w.options.welcomeEmailTemplate,l="";a?(r="put",l=e):s+="&verificationtoken="+e+"&url="+w.options.verificationUrl;var c="##otp";w.options.verifyEmailByOTP&&(c=""),w.util.ajaxCall(r,s,l,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):w.options.loginOnEmailVerification?null==e.Data?o(e):k.loginHandleToken(e.Data,"",o,t):w.options.logoutOnVerifyEmail?k.logout(o(e)):o(e)},"verifyEmail"+c)}else t(a?[T.notFound]:[T.vTokenError])},L.deleteUserConfirmController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/delete?apiKey="+w.options.apiKey+"&deletetoken="+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"deleteUserConfirm"):t([T.vTokenError])},L.checkEmailAvailabilityController=function(e,o,t){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email?apiKey="+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"checkEmail")},L.checkUserNameAvailabilityController=function(e,o,t){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/username?apiKey="+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"checkUsername")},L.resetPasswordBySecurityQuestionController=function(o,t,n){var e=k.sanitizeSecurityQuesData(o);w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/password/securityanswer/?apikey="+w.options.apiKey,e,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,o)},"resetPasswordBySecurityQuestion")},L.resetPINBySecurityQuestionController=function(o,t,n){var e=k.sanitizeSecurityQuesData(o),i=e.hasOwnProperty("email")?"email":e.hasOwnProperty("phone")?"phone":"username";w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/pin/reset/securityanswer/"+i+"?apikey="+w.options.apiKey,e,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e,o)},"resetPINBySecurityQuestion")},L.getSecurityQuestionsController=function(e,o,t){var n="/auth/securityquestion/";-1!==e.indexOf("username")?n+="username?apiKey=":-1!==e.indexOf("phone")?n+="phone?apiKey=":n+="email?apiKey=",w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+n+w.options.apiKey+"&"+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(function(e){for(var o=[],t=0;t<e.length;t++){var n={};w.options.maskSensitiveInput?n.type="password":n.type="string",n.name=e[t].QuestionId,n.display=e[t].Question,n.rules="required",n.permission="r",o.push(n)}return o}(e))},"securityQuestion")},L.getBackupCodeController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"backupCode"):t([k.setMappedMessage(T.twofaTokenValid)])},L.resetBackupCodeController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA/backupcode/reset?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"backupCode"):t([k.setMappedMessage(T.twofaTokenValid)])},L.getSocialDataController=function(e,o,t,n,i){e?(n+="?access_token="+e,i&&(n=n+"&"+i),w.util.ajaxCall("get",LoginRadiusDefaults.socialApiDomain+n,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"socialAPI")):t([k.setMappedMessage(T.twofaTokenValid)])},L.postSocialDataController=function(e,o,t,n,i,a){e?(n+="?access_token="+e,i&&(n=n+"&"+i),w.util.ajaxCall("post",LoginRadiusDefaults.socialApiDomain+n,a,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"socialAPI")):t([k.setMappedMessage(T.twofaTokenValid)])},L.createCustomObjectController=function(e,o,t,n){e?w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+w.options.apiKey+"&access_token="+e+"&objectname="+w.options.customObjectName,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e)},"createCustomObject"):n([k.setMappedMessage(T.twofaTokenValid)])},L.getCustomObjectByIdController=function(e,o,t,n){i("get",e,o,t,n)},L.getCustomObjectsController=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/customobject?apiKey="+w.options.apiKey+"&access_token="+e+"&objectname="+w.options.customObjectName,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"getCustomObject"):t([k.setMappedMessage(T.twofaTokenValid)])},L.updateCustomObjectController=function(e,o,t,n,i,a){if(e){var r="";n&&(r="&updatetype="+n),w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/customobject/"+o+"?apiKey="+w.options.apiKey+"&access_token="+e+"&objectname="+w.options.customObjectName+r,t,function(e){e.ErrorCode?a(k.loginRadiusErrorTojsError(e)):i(e)},"updateCustomObject")}else a([k.setMappedMessage(T.twofaTokenValid)])},L.deleteCustomObjectController=function(e,o,t,n){i("delete",e,o,t,n)},L.updateData=function(o,u,p,d,m,g,f,e,t){var h=o.Profile||o.Data,v=p;w.lrApiFramework||(v=k.mapRegistrationSchema(f,p,h)),w.options.isPINAuthentication&&(v=k.sanitizePinData(v));var y=o.access_token;t=t||w.setHostedToken,e=e||"updateData",w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate,0<Object.keys(v).length?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+w.options.apiKey+"&access_token="+y+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.verificationEmailTemplate,v,function(c){if(c.ErrorCode)m(k.loginRadiusErrorTojsError(c));else{function e(e){var o,t;o=v.emailid||v.email,t=v.phone||v.phoneid;var n=w.util.findInSchema(f,"name","phoneid"),i=n&&-1!==n.rules.indexOf("required"),a=w.util.findInSchema(f,"name","emailid"),r=a&&-1!==a.rules.indexOf("required");w.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,h.Uid);var s,l=w.util.parseQueryString(window.location.search.replace("?",""));if((void 0===t||t)&&h.PhoneIdVerified&&void 0===o||(void 0===o||o)&&h.EmailVerified&&void 0===t||(t&&!i||void 0===t)&&(w.options.disabledEmailVerification||w.options.optionalEmailVerification))o&&!h.EmailVerified&&l.return_url&&-1!==l.return_url.toLowerCase().indexOf("/saml/")?m([k.setMappedMessage(T.emailNotVerified)]):(delete c.IsPosted,c.access_token=y,e(),LoginRadiusDefaults.isSSOInitFired&&k.setToken(y));else if(t&&h&&!h.PhoneIdVerified){(s=new SetLoginRadiusCommonFunctions(w)).verifyOTP(p,u,d,m,g),s.resendOTP(p+"&noPhoneVerified=false",u,d,m,g)}else!o||!r||h.EmailVerified||w.options.disabledEmailVerification||w.options.optionalEmailVerification?e():m([k.setMappedMessage(T.emailNotVerified)])}e(t?function(){o.Data=o.Profile,delete o.Profile,c.Data&&(o.Data=c.Data),k.loginHandleToken(o,p,d,m)}:function(){c.Data&&(c.Profile=c.Data,delete c.Data,delete c.IsPosted),c.access_token?k.loginHandleToken(c,p,d,m):d(c,w.util.parseQueryString(p))})}},e):k.loginHandleToken(o,p,d,m)},L.oneTouchLoginController=function(e,r,o,t,s,n){function i(t,e,n,o,i,a){k.createForm(w.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var o={};o.Profile=t,o.access_token=n,L.updateData(o,r,e,i,a,s,w.registrationFormSchema,"login",!0)},function(e){a(k.setMappedMessage(e))})}var a=w.util.checkPhoneOrEmailLogin(e),l=w.util.parseQueryString(a),c=n?"POST":"GET",u="";if(l.phone){var p=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/phone?apikey="+w.options.apiKey+"&smstemplate="+w.options.smsTemplateOneTouchLogin;n?u=Object.assign({},l):p=p+"&"+a,w.util.ajaxCall(c,p,u,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):(k.verifyOTP(a+"&onetouchloginflag=true",r,o,t,s,"",i),k.resendOTP(a+"&onetouchloginflag=true",r,o,t,s,"",i))},"oneTouchLogin")}else{var d=w.util.randomString(16),m=w.options.noRegistrationEmailTemplate||w.options.onetouchLoginEmailTemplate,g=LoginRadiusDefaults.apiDomain+"/auth/onetouchlogin/email?apikey="+w.options.apiKey+"&onetouchloginemailtemplate="+m+"&welcomeemailtemplate="+w.options.welcomeEmailTemplate+"&redirectUrl="+w.options.onetouchLoginRedirectUrl;n?u=Object.assign({},l,{clientGuid:d}):g=g+"&"+a+"&clientGuid="+d,w.util.ajaxCall(c,g,u,function(e){if(e.ErrorCode)t(k.loginRadiusErrorTojsError(e));else if(e.IsPosted){o(e);k.pingForSmartLogin(d,function(e){w.options.askRequiredFieldsOnPasswordLessLogin?(LoginRadiusDefaults.autoFilledFieldforPasswordLesLogin=!0,L.handleFeatures(e,a,i,"",o,t)):k.loginHandleToken(e,"",o,t,"",!0)},t)}},"oneTouchLogin")}},L.smartLoginController=function(e,o,t){var n=w.util.randomString(16),i=w.options.autoLoginRedirectUrl||w.options.smartLoginRedirectUrl,a=w.options.autoLoginEmailTemplate||w.options.smartLoginEmailTemplate;w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/smartlogin?apikey="+w.options.apiKey+"&"+e+"&clientGuid="+n+"&smartloginemailtemplate="+a+"&welcomeemailtemplate="+w.options.welcomeEmailTemplate+"&redirectUrl="+i,"",function(e){if(e.ErrorCode)t(k.loginRadiusErrorTojsError(e));else if(e.IsPosted){o(e);k.pingForSmartLogin(n,function(e){k.loginHandleToken(e,"",o,t)},t)}},"smartLogin")},L.verifyInstantOTP=function(o,e,t,n,i,a,r){var s="phone="+e.phone+"&"+o;w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/otp/verify?apiKey="+w.options.apiKey+"&smsTemplate="+w.options.smsTemplateWelcome,s,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):k.loginHandleToken(e,o,t,n)},"login##otp")},L.socialLoginReceiveToken=function(d,m,g,f,h,v,e){w.currentLRContainer=m,w.options.verificationEmailTemplate=w.options.emailTemplate||w.options.verificationEmailTemplate,w.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,d);var y,C;e=e&&0<e.length?e:w.options.RegistrationFormSchema,y=e,C=JSON.parse(JSON.stringify(y)),w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+w.options.apiKey+"&access_token="+d+"&verificationUrl="+w.options.verificationUrl+"&emailTemplate="+w.options.verificationEmailTemplate,"",function(e){if(e.ErrorCode)f(k.loginRadiusErrorTojsError(e));else if(w.LRCheckLogin=!0,e.IsDeleted)f([k.setMappedMessage(T.blockedUser)]);else{var o={};o.Profile=e,o.access_token=d,k.setPasswordRule(w.util.findInSchema(C,"name","password")),k.setPasswordRule(w.util.findInSchema(C,"name","confirmpassword"));var t=!1;w.options.autoFilledFieldForSocial&&(t=!0,w.$hooks.register("beforeFormRender",function(e,o){if("socialRegistration"===e){var t=w.util.findInSchema(o,"name","emailid");t&&t.value&&(t.disabled=!0);var n=w.util.findInSchema(o,"name","phoneid");n&&n.value&&(n.disabled=!0)}})),w.registrationFormSchema=k.mapSchema(C,e,t),w.$hooks.call("registrationSchemaFilter",C,e);var n=w.storage.getBrowserStorage("LRTraditionalLogin");if(w.storage.removeBrowserStorage("LRTraditionalLogin"),0<w.registrationFormSchema.length&&!n)m?(w.$hooks.call("socialLoginFormRender"),k.createForm(w.registrationFormSchema,"socialRegistration",m,function(e){L.updateData(o,m,e,g,f,h,w.registrationFormSchema,"socialLogin")},function(e){f(e)},h)):v(d,w.registrationFormSchema,e);else{var i=w.util.findInSchema(y,"name","phoneid"),a=i&&-1!==i.rules.indexOf("required"),r=a?!!e.PhoneIdVerified:e.PhoneIdVerified,s=w.util.findInSchema(y,"name","emailid"),l=s&&-1!==s.rules.indexOf("required"),c=l?!!e.EmailVerified:e.EmailVerified;if((!r&&a||!c&&l)&&(!r&&a||!w.options.disabledEmailVerification&&!w.options.optionalEmailVerification))if(null==e.Email||e.EmailVerified){var u={phone:e.PhoneId};f([k.setMappedMessage(T.phoneNotVerified)],u);var p=h+LoginRadiusDefaults.idPrefix+"recaptcha_widget_verifyotp";L.resendOTPController(u,function(){w.socialLoginFlag=!0,k.verifyOTP("phone="+e.PhoneId,m,g,f,h),k.resendOTP("phone="+e.PhoneId+"&noPhoneVerified=false",m,g,f,h)},f,p,m,h)}else f([k.setMappedMessage(T.emailNotVerified)]);else w.storage.setBrowserStorage(LoginRadiusDefaults.storedUidName,e.Uid),LoginRadiusDefaults.isSSOInitFired&&k.setToken(d),k.loginHandleToken(o,"",g,f)}}},"socialLogin")},L.accountLinkingReceiveToken=function(o,t,n){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+w.options.apiKey+"&access_token="+o,"",function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):e.Uid!==w.storage.getBrowserStorage(LoginRadiusDefaults.storedUidName)?w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/socialidentity?apiKey="+w.options.apiKey+"&access_token="+w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"candidatetoken="+o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):t(e)},"linkAccount"):t({IsPosted:!0})},"linkAccount")},L.validateToken=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/Validate?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"validateToken"):t([setMappedMessage(T.twofaTokenValid)])},L.invalidateToken=function(e,o,t){e?w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/access_token/InValidate?apikey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"invalidateToken"):t([setMappedMessage(T.twofaTokenValid)])},L.updatePrivacyPolicy=function(t,n,i,a,r,s,l){w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/privacypolicy/accept?apikey="+w.options.apiKey+"&access_token="+t,"",function(e){var o;e.ErrorCode?a(k.loginRadiusErrorTojsError(e)):(r?o=e:((o=n.Data||{}).access_token=t,o.Profile=e,o.Profile=Object.assign({},o.Profile,{IsLatestPrivacyPolicy:!0})),o.Profile&&("email"===o.Profile.RegistrationProvider.toLowerCase()?k.loginHandleToken(o,"",i,a):new LoginRadiusControllers(w,k).socialLoginReceiveToken(t,s,i,a,l)))},"updatePrivacyPolicy")},L.configurePINController=function(e,o,t,n,i,a){w.util.ajaxCall("POST",LoginRadiusDefaults.apiDomain+"/auth/pin/set/pinauthtoken?apikey="+w.options.apiKey+"&pinauthtoken="+e,o,function(e){e&&e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?k.loginHandleToken(e,"",t,n):new LoginRadiusControllers(w,k).socialLoginReceiveToken(e.access_token,i,t,n,a))},"pinSetup")},L.pinReauthController=function(e,o,t,n){var i=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/account/reauth/pin?apiKey="+w.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"pinreauthentication")},L.customEventConsentController=function(e,o,t,n){var i=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/profile?apiKey="+w.options.apiKey+"&access_token="+i,e,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"customeventconsent")},L.submitConsentController=function(e,o,t,n,i,a){e&&w.util.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+w.options.apiKey+"&consenttoken="+e,o,function(e){e.ErrorCode?n(k.loginRadiusErrorTojsError(e)):e&&e.Profile&&("email"===e.Profile.RegistrationProvider.toLowerCase()?k.loginHandleToken(e,"",t,n):L.socialLoginReceiveToken(e.access_token,i,t,n,a))},"submitconsent")},L.verifyConsentController=function(e,o,t){var n=!!e.isCustom&&e.isCustom,i=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);i&&w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/verify?apiKey="+w.options.apiKey+"&access_token="+i+"&event="+e.event+"&isCustom="+n,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"verifyconsent")},L.consentLogsController=function(o,t){var e=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e&&w.util.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/consent/logs?apiKey="+w.options.apiKey+"&access_token="+e,"",function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"cosentlogs")},L.updateConsentController=function(e,o,t){var n=w.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);n&&w.util.ajaxCall("put",LoginRadiusDefaults.apiDomain+"/auth/consent/?apiKey="+w.options.apiKey+"&access_token="+n,e,function(e){e.ErrorCode?t(k.loginRadiusErrorTojsError(e)):o(e)},"updateconsent")}}var LoginRadiusV2=function(t){this.global=window;var Ee=this,Ie=new SetLoginRadiusCommonFunctions(Ee),Ae=new LoginRadiusControllers(Ee,Ie),De=LoginRadiusDefaults.buttonNames,Oe=LoginRadiusDefaults.messages,Fe=LoginRadiusDefaults._uuidFormat,e=hash.get("lr-token");try{e&&window.opener&&window.opener.html5passToken&&(window.opener.html5passToken(e),document.write("<style type='text/css'>body { display: none !important; } </style>"),hash.remove("lr-token"),window.close())}catch(e){}var o=new LRNameSpace.Utilities;Ee.util=new LoginRadiusUtility(Ee,t),Ee.storage=new LRNameSpace.Storage(Ee,LoginRadiusDefaults);var Ne=Ee.util=Object.assign(o,Ee.util,Ee.storage);function xe(e,o,t,n){e&&Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/login/passwordlesslogin/email/verify?apiKey="+Ee.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+Ee.options.welcomeEmailTemplate,"",function(e){e.ErrorCode?t(Ie.loginRadiusErrorTojsError(e)):Ie.loginHandleToken(e,"",o,t,n)},"passwordlessLogin")}function je(r,i,a,s){function o(e,t){Ie.createForm(e,t,r,function(n){if(Ee.LRCheckLogin=!0,window.lrpasswordlesslogin)Ie.sendInstantSignInLink(n,i,a,r,s);else if(window.lrpasswordlessloginotp)Ie.sendInstantSignInOtp(n,i,a,r,s);else{function e(t,e,n,o,i,a){Ie.createForm(Ee.registrationFormSchema,"loginRequiredFieldsUpdate",r,function(e){var o={};o.Profile=t,o.access_token=n,Ae.updateData(o,r,e,i,a,s,Ee.registrationFormSchema,"login",!0)},function(e){a(Ie.setMappedMessage(e))})}function o(o,t){Ie.createForm(Ee.changePasswordFormSchema,"changepassword",r,function(e){Ae.periodicalPasswordRestController(e,i,a,o,t,n)},function(e){a(e)})}Ee.options.twoFactorAuthentication||Ee.options.optionalTwoFactorAuthentication?Ae.login2FAController(n,r,i,a,s,o,e):"pinLogin"===t?Ae.loginPINController(n,r,i,a,s,o,e,l):Ae.loginController(n,r,i,a,o,e,s)}},function(e){a(Ie.setMappedMessage(e))},s)}var t,e=Ne.getHashParam("vtoken"),n=Ne.getHashParam("vtype"),l=Ee.getSessionToken();if(Ee.currentLRContainer=r,"oneclicksignin"!==n&&"passwordlesslogin"!==n||Ee.passwordlessLoginFlag||(Ee.passwordlessLoginFlag=!0,xe(e,i,a,s)),t=Ee.loginFormSchema,Ee.loginAction=!0,Ue(t),t=JSON.parse(JSON.stringify(function(e){if(Ee.options.stayLogin){for(var o=!0,t=0;t<e.length;t++)"stayLogin"===e[t].name&&(o=!1);if(o){e.push({type:"multi",name:"stayLogin",display:"Remember me",rules:null,permission:"w"})}}return e}(t))),Ie.setPasswordRule(t[1],Ee.loginAction),!Ee.passwordlessLoginFlag&&!Ee.options.twoFactorAuthentication&&!Ee.options.optionalTwoFactorAuthentication&&Ee.options.isPINAuthentication&&Ee.options.PINConfiguration&&Ee.options.PINConfiguration.PINLogin&&l){var c=Ee.pinLoginFormSchema.slice(),u=Object.assign({},Ee.defaultBtnSchema,{name:"backtologinform",display:LoginRadiusDefaults.buttonNames.pinloginbackbtn,eventCallback:function(e){o(t,"login")}});c.push(u),Ee.loginAction=!0,t.rules="required",o(c,"pinLogin")}else o(t,"login")}function _e(n,i,a,r,s){Ee.$hooks.call("registrationSchemaFilter",s);var l=r+LoginRadiusDefaults.idPrefix+"recaptcha_widget_registration";if(Ee.options.isConsentManagementEnabled||Ne.captchaSchema(l,s),Ee.options.privacyPolicyConfiguration.IsEnabled){var e=Ee.privacyPolicySchema.slice();e[0].rules="Strict"===Ee.options.privacyPolicyConfiguration.Mode?"required":"",s.push(e[0])}if(Ee.options.isPINAuthentication&&Ee.options.PINConfiguration.AskOnRegistration)Ie.setPINRule(Ne.findInSchema(s,"name","pin")),Ie.setPINRule(Ne.findInSchema(s,"name","confirmpin"));else{for(var o=[],t=0;t<s.length;t++)"pin"!==s[t].name&&"confirmpin"!==s[t].name&&o.push(s[t]);s=o}if(s.push({type:"html",name:"termsandcondition",html:Ee.options.termsAndConditionHtml||""}),Ie.setPasswordRule(Ne.findInSchema(s,"name","password")),Ie.setPasswordRule(Ne.findInSchema(s,"name","confirmpassword")),Ee.registrationFormSchema=s,Ee.options.isConsentManagementEnabled){Ee.getConsentConfiguration(function(e){var o=Ie.createConsentInterface(e.Register);if(""!==o){var t={html:o,name:"consent",type:"html"};s.push(t)}Ne.captchaSchema(l,s),c(s,n,i,a,l,r),Ne.renderV2Recaptcha(l,!0)})}else c(s,n,i,a,l,r),Ne.renderV2Recaptcha(l,!0)}function c(t,n,i,a,r,s){Ie.createForm(t,"registration",n,function(e){var o=Ie.consentValidation(e,"Register");0<o.length?a(o):Ae.registrationController(e,n,function(e,o){window.grecaptcha&&Ee.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),i(e,o)},function(e){window.grecaptcha&&Ee.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),a(e)},s,t)},function(e){window.grecaptcha&&Ee.options.v2Recaptcha&&grecaptcha.reset(window[r+"lr_recaptcha_widgets_idprefix"]),a(e)},s)}function Me(n,i,a,r){function o(e){var o=Ne.getHashParam("vtoken");if(Ee.options.verifyEmailByOTP){var t={};e&&(t=Ne.mergeOptions(t,Ne.parseQueryString(e))),t.otp=o;try{t.email=Ne.getQueryParameterByName("email").replace(/ /g,"+"),Ae.emailVerificationController(t,n,i,a,r,!0)}catch(e){Ee.log(e)}}else Ae.emailVerificationController(o,n,i,a,r)}if(a&&"Captcha"===Ee.options.loginLockedType){Ee.$hooks.register("afterFormRender",function(e,o,t,n){n&&"loginradius-verifyemail"===n.name&&"loginradius-submit-verify"===n[0].id&&(n[0].style.display="none")}),Ie.createForm([],"verifyemail",a,function(e){o(e)},function(e){i(e)},r)}o()}function Be(t,n,i,e){var o=document.createElement("input");o.setAttribute("type","button");var a=Ee.buttonsName["createTwoFactorAuthentication".toLowerCase()]||De.createtwofactorauthentication;o.setAttribute("value",a);var r=e||LoginRadiusDefaults.classPrefix;document.getElementsByName(r+"profileeditor")[0]?Ee.options.showTwoFactorOnProfile&&document.getElementsByName(r+"profileeditor")[0].appendChild(o):(Ee.options.twoFactorAuthentication||Ee.options.optionalTwoFactorAuthentication)&&Ne.addHTMLContent(t,o);Ne.addEvent("click",o,function(e){Ee.options.optionalTwoFactorAuthentication||Ee.options.twoFactorAuthentication?Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+Ee.options.apiKey+"&access_token="+Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){if(Ee.LRCheck2FA=!0,Ee.LRCheckLogin=!1,e.ErrorCode)i(Ie.loginRadiusErrorTojsError(e));else{Ee.storage.setBrowserStorage(LoginRadiusDefaults.storedOTPAuth,e.IsOTPAuthenticatorVerified),Ee.storage.setBrowserStorage(LoginRadiusDefaults.storedGAAuth,e.IsGoogleAuthenticatorVerified);var o=e.IsOTPAuthenticatorVerified;Ee.options.googleAuthentication&&(Ie.showQRCode(e,t,n,i,r),LoginRadiusDefaults.innerHTML=!0),o?Ie.changeNumberForm(t,"",n,i,r,LoginRadiusDefaults.innerHTML):Ie.updatePhoneNumber(t,n,i,r,"updatePhone2FA")}},"createTwoFactorAuthentication"):Ee.log("Two Factor Authentication will not work, please set in commonOpitons either twoFactorAuthentication or optionalTwoFactorAuthentication")})}function Ve(s,l,c,u){var p=Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);if(p){function i(r){Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+Ee.options.apiKey+"&access_token="+p,"",function(e){var o=JSON.parse(JSON.stringify(r));o=Ie.mapSchema(o,e,"profileeditor");var t=[],n=[],i={};i.Profile=e,i.access_token=p;for(var a=0;a<o.length;a++)o[a].name&&-1===o[a].name.indexOf("emailid")&&-1===o[a].name.indexOf("phoneid")&&t.push(o[a]),o[a].permission&&"h"!==o[a].permission&&n.push(o[a]);Ie.createForm(t,"profileeditor",s,function(e){Ae.updateData(i,s,e,l,c,u,t,"profileEditor")},function(e){c(e)},u),(Ee.options.optionalTwoFactorAuthentication||Ee.options.twoFactorAuthentication)&&Be(s,l,c,u),Ee.$hooks.call("renderProfileEditorHook",e,n)},"profileEditor")}Ee.registrationFormSchema=Ee.registrationFormSchema&&0<Ee.registrationFormSchema.length?Ee.registrationFormSchema:Ee.options.RegistrationFormSchema,Ee.progressiveProfiling.showInEditor?Ee.progressiveProfiling.fetchSchema(function(e){var o=Ee.registrationFormSchema.slice();if(e&&e.ProfilingSteps){for(var t=[],n=0;n<e.ProfilingSteps.length;n++)t=t.concat(e.ProfilingSteps[n].Schema);o=o.concat(t)}i(o)}):i(Ee.registrationFormSchema)}else c([Ie.setMappedMessage(Oe.tokenValid)])}function Ke(e,o){var t=[];if(Ee.options.SecurityQuestions){function n(e){var o=new RegExp("securityQuestion"),t=e.target.id.split("securityQuestion")[1];r[t]=e.target.selectedIndex;for(var n=Ne.findElementByRegex("id",o,"select"),i=0;i<n.length;i++)for(var a=1;a<n[i].options.length;a++)-1<r.indexOf(n[i].options[a].index)&&n[i].options[a].index!==n[i].options.selectedIndex?n[i].options[a].style.display="none":n[i].options[a].style.display="block"}for(var i=[],r=[],a=0;a<Ee.options.SecurityQuestions.length;a++){var s={};s.text=Ee.options.SecurityQuestions[a].Question,s.value=Ee.options.SecurityQuestions[a].QuestionId,i.push(s),r.push(0)}for(var l=0;l<Ee.options.securityQuestionsCount;l++){var c={type:"option"};c.options=i,c.name="securityQuestion"+l,c.display="Security Question",c.event="change",c.eventCallback=n,c.rules=o?"optional":"required",c.permission="r",o?e.push(c):t.push(c);var u={};Ee.options.maskSensitiveInput?u.type="password":u.type="string",u.name="securityAnswer"+l,u.display="Answer",u.rules=o?"optional":"required",u.permission="r",o?e.push(u):t.push(u)}}return t}function Ue(e){if(Ee.options.duplicateEmailWithUniqueUsername){var o=Ne.findInSchema(e,"name","emailid");o.display="Username",o.rules="required"}else{var t;Ee.options.usernameLogin&&-1===(t=Ne.findInSchema(e,"name","emailid")).display.indexOf("/Username")&&(t.display=t.display+"/Username",t.rules="required"),(Ee.options.phoneLogin||Ee.options.passwordlessLoginOTP)&&(t||((t=Ne.findInSchema(e,"name","emailid")).rules="required"),-1===t.display.indexOf("/Phone")&&(t.display=t.display+"/Phone"))}}function Qe(o,t,n,i){var e,a,r,s=Ne.getHashParam("vtoken"),l=Ne.getHashParam("vtype"),c=!1;Ee.options.v2Recaptcha||Ee.options.invisibleRecaptcha||Ee.options.tencentCaptcha||Ee.options.tencentCaptchaAsFallback?c=!0:Ee.options.privacyPolicyConfiguration.IsEnabled&&Ee.log("Captcha should be enabled for passwordless login if using with privacy policy"),"noregistration"!==l&&"onetouchlogin"!==l||(a=t,r=n,(e=s)&&Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/email/autologin?apiKey="+Ee.options.apiKey+"&verificationtoken="+e+"&welcomeEmailTemplate="+Ee.options.welcomeEmailTemplate,"",function(e){e.ErrorCode?r(Ie.loginRadiusErrorTojsError(e)):Ie.loginHandleToken(e,"",a,r)},"smartlogin"));var u,p=Ee.passwordLessLoginSchema;if(Ee.options.phoneLogin){var d=Ne.findInSchema(p,"name","emailid");d.display=d.display+"/Phone"}c&&(Ne.addRecaptchaJS(),u=i+LoginRadiusDefaults.idPrefix+o,Ne.captchaSchema(u,p)),Ie.createForm(p,"oneTouchLogin",o,function(e){Ae.oneTouchLoginController(e,o,t,n,i,c)},function(e){n(e)},i),c&&Ne.renderV2Recaptcha(u,!0)}function qe(a,r,s,l){var e=Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);if(e){Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+Ee.options.apiKey+"&access_token="+e,"",function(o){Ee.getConsentConfiguration(function(e){!function(e){var o,t=[],n="";e&&e.ConsentProfile&&e.ConsentProfile.Consents&&(o=e.ConsentProfile.Consents,n=Ie.createConsentOptionInterface(Ee.consentsList,o));var i={html:n,name:"consent",type:"html"};t.push(i),Ie.createForm(t,"consenteditor",a,function(e){var o=Ie.consentValidation(e);if(0<o.length)s(o);else{var t=Ee.util.parseQueryString(e),n=[];for(var i in t){var a=i.replace("consent_","");n.push({ConsentOptionId:a,IsAccepted:t[i]})}(t={}).Consents=n,Ae.updateConsentController(t,r,s)}},function(e){s(e)},l)}(o)})})}else s([Ie.setMappedMessage(Oe.tokenValid)])}function n(ke,Te){var Le=(Te=Te||{}).onSuccess||function(){},Se=Te.onError||function(){},Pe=Te.container||"",Re=Te.classPrefix||"",be=Te.templateName||"";Ee.$hooks.register("getCurrentActionOptions",function(e){ke==e&&(window.LRSafarionSuccess=Le||function(){},window.LRSafarionError=Se||function(){}),Ee.currentActionOptions={},Ee.currentActionOptions.onSuccess=Le||function(){},Ee.currentActionOptions.onError=Se||function(){},Ee.currentActionOptions.container=Pe,Ee.currentActionOptions.classPrefix=Re||"",Ee.currentActionOptions.templateName=be||""}),Ee.getAppConfiguration(function(){switch("registration"!==ke&&"updateSecurityQuestion"!==ke&&Ee.$hooks.call("beforeInit",ke),ke){case"privacyPolicyUpdate":!function(o,t,n,i){if(Ee.options.privacyPolicyConfiguration.IsEnabled){var a=Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);if(a){var e=Ee.privacyPolicySchema.slice();e[0].rules="Strict"===Ee.options.privacyPolicyConfiguration.Mode?"required":"",Ie.createForm(e,"privacyPolicyUpdate",o,function(e){Ae.updatePrivacyPolicy(a,"",t,n,!0,o,i)},function(e){n(Ie.setMappedMessage(e))})}else n([Ie.setMappedMessage(Oe.tokenValid)])}}(Pe,Le,Se,Re);break;case"login":je(Pe,Le,Se,Re);break;case"registration":var e;e=setInterval(function(){var r,s,l,c;LoginRadiusDefaults.isRegFormSchemaLock||(LoginRadiusDefaults.isRegFormSchemaLock=!0,Ee.$hooks.call("beforeInit",ke),r=Pe,s=Le,l=Se,c=Re,Ne.addRecaptchaJS(),Ee.registrationFormSchema=Ee.registrationFormSchema&&0<Ee.registrationFormSchema.length?Ee.registrationFormSchema:Ee.options.RegistrationFormSchema,function(e){for(var o=JSON.parse(JSON.stringify(e)),t=[],n=0;n<o.length;n++)if(o[n]&&Ee.options.showSplitForm&&o[n].DataSource&&null!==o[n].DataSource){var i=JSON.parse(JSON.stringify(o[n])),a=JSON.parse(JSON.stringify(Ne.findInSchema(o,"name","cf_"+o[n].DataSource+"Code")));i.name="recordid",a.name="code",t.push(i),t.push(a)}0<t.length&&Ee.options.showSplitForm?Ie.createForm(t,"validatecode",r,function(e){Ne.ajaxCall("post",LoginRadiusDefaults.apiDomain+"/auth/registrationdata/validatecode?apiKey="+Ee.options.apiKey,e,function(e){1==e.IsValid?_e(r,s,l,c,o):l(e)},"registration")}):(Ee.options.securityQuestionEnabled&&Ee.options.SecurityQuestions&&Ke(o,!0),_e(r,s,l,c,o))}(Ee.registrationFormSchema),clearInterval(e))},1e3);break;case"resetPassword":Ie.resetPassword(Pe,Le,Se,Re);break;case"resetPIN":Ie.resetPIN(Pe,Le,Se,Re);break;case"forgotPassword":he=Pe,ve=Le,ye=Se,Ce=Re,Ue(we=Ee.forgotPasswordFormSchema),Ie.createForm(we,"forgotpassword",he,function(e){-1!==(e=Ne.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,Ae.forgotPasswordbyPhoneController(e,he,ve,ye,Ce)):Ae.forgotPasswordController(e,he,ve,ye,Ce)},function(e){ye(e)},Ce);break;case"forgotPIN":pe=Pe,de=Le,me=Se,ge=Re,Ue(fe=Ee.forgotPINFormSchema),Ie.createForm(fe,"forgotPIN",pe,function(e){-1!==(e=Ne.checkPhoneOrEmailLogin(e)).indexOf("phoneApi=1")?(LoginRadiusDefaults.LRPhoneNo=e,Ae.forgotPINbyPhoneController(e,pe,de,me,ge)):Ae.forgotPINController(e,pe,de,me,ge)},function(e){me(e)},ge);break;case"verifyEmail":Me(Le,Se,Pe,Re);break;case"changePassword":re=Pe,se=Le,le=Se,ce=Re,ue=Ee.changePasswordFormSchema,Ie.setPasswordRule(Ne.findInSchema(ue,"name","newpassword")),Ie.setPasswordRule(Ne.findInSchema(ue,"name","confirmnewpassword")),Ie.createForm(ue,"changepassword",re,function(e){Ae.changePasswordController(e,se,le)},function(e){le(e)},ce);break;case"changePIN":oe=Pe,te=Le,ne=Se,ie=Re,ae=Ee.changePINFormSchema.slice(),Ie.setPINRule(Ne.findInSchema(ae,"name","newpin")),Ie.setPINRule(Ne.findInSchema(ae,"name","confirmnewpin")),Ie.createForm(ae,"changepin",oe,function(e){Ae.changePINController(e,te,ne)},function(e){ne(e)},ie);break;case"socialLogin":var o=Ne.elementById(Pe);o&&Ne.addEvent("click",o,function(){LoginRadiusDefaults.socialRegFormId=this.id}),LoginRadiusDefaults.socialRegFormId=Pe,Ie.socialLogin(Pe,Le,Se,Re);break;case"linkAccount":!function(i,a,r,s){if(Ee.options.disableAccountLinking)Ee.log(Oe.disabledAccountLinking);else{var l=i.split(","),e=Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);e?Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+Ee.options.apiKey+"&access_token="+e,"",function(e){if(e.ErrorCode)r(Ie.loginRadiusErrorTojsError(e));else if(e.EmailVerified||e.PhoneIdVerified){var o={};if(e.Identities)for(var t=0,n=e.Identities.length;t<n;t++)o[e.Identities[t].Provider]=e.Identities[t].ID;1===l.length?Ie.renderCustomInterface(i,o,s,"",!0):Ie.renderCustomInterface(i,o,Ee.options.linkedAccountsTemplate+","+Ee.options.notLinkedAccountsTemplate,!0,!0),window.html5passToken=function(e){Ae.accountLinkingReceiveToken(e,a,r)},Ee.options.isMobile||Ee.options.noCallbackForSocialLogin?Ee.$hooks.register("socialCalls",function(e,o){if(Ee.options.noCallbackForSocialLogin){Ie.pingForSmartLogin(o,function(e){e.access_token?Ae.accountLinkingReceiveToken(e.access_token,a,r):a(e)},function(){})}}):Ne.addEvent("message",window,function(e){-1===e.origin.indexOf(Ee.options.customDomain)&&-1===e.origin.indexOf(LoginRadiusDefaults.hubDomain)||"string"==typeof e.data&&Fe.test(e.data)&&Ae.accountLinkingReceiveToken(e.data,a,r)})}else r([Ie.setMappedMessage(Oe.unverifiedUser)])},"linkAccount"):r([Ie.setMappedMessage(Oe.tokenValid)])}}(Pe,Le,Se,be);break;case"unLinkAccount":var t=Ne.unLinkAccount;Ne.unLinkAccount=function(e,o){t(e,o,Le,Se)};break;case"profileEditor":Ve(Pe,Le,Se,Re);break;case"deleteUser":X=Le,Y=Se,(ee=Ee.sessionData.getToken())?Ne.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/account?apiKey="+Ee.options.apiKey+"&access_token="+ee+"&deleteUrl="+Ee.options.deleteUrl+"&emailTemplate="+Ee.options.deleteUserEmailTemplate,{},function(e){e.ErrorCode?Y(Ie.loginRadiusErrorTojsError(e)):X(e)},"deleteUser"):Y([Oe.vTokenError]);break;case"deleteUserConfirm":z=Le,W=Se,Z=Ne.getHashParam("vtoken"),Ae.deleteUserConfirmController(Z,z,W);break;case"updatePhone":Ee.LRCheck2FA=!1,Ie.updatePhoneNumber(Pe,Le,Se,Re);break;case"changeUsername":H=Pe,$=Le,G=Se,J=Re,Ie.createForm(Ee.changeUsernameFormSchema,"changeUsername",H,function(e){Ae.changeUsernameController(e,$,G)},function(e){G(e)},J);break;case"resendVerificationEmail":K=Pe,U=Le,Q=Se,q=Re,Ie.createForm(Ee.emailSchema,"resendEmailVerification",K,function(e){Ae.resendEmailVerificationController(e,U,Q)},function(e){Q(e)},q);break;case"addEmail":_=Pe,M=Le,B=Se,V=Re,Ie.createForm(Ee.addEmailSchema,"addemail",_,function(e){Ae.addEmailController(e,M,B)},function(e){B(e)},V);break;case"removeEmail":F=Pe,N=Le,x=Se,j=Re,Ie.createForm(Ee.emailSchema,"removeemail",F,function(e){Ae.removeEmailController(e,N,x)},function(e){x(e)},j);break;case"createTwoFactorAuthentication":Be(Pe,Le,Se,Re);break;case"backupCodeButton":A=Pe,D=Le,O=Se,Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+Ee.options.apiKey+"&access_token="+Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){if(e.IsOTPAuthenticatorVerified||e.IsGoogleAuthenticatorVerified){var o=document.createElement("input");o.setAttribute("type","button");var t=Ee.buttonsName["backupCode".toLowerCase()]||De.backupCode;o.setAttribute("value",t),Ne.addHTMLContent(A,o),Ne.addEvent("click",o,function(e){Ee.api.getBackupCode(Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),D,O)})}});break;case"resetBackupCodeButton":b=Pe,E=Le,I=Se,Ne.ajaxCall("get",LoginRadiusDefaults.apiDomain+"/auth/account/2FA?apikey="+Ee.options.apiKey+"&access_token="+Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),"",function(e){if(e.IsOTPAuthenticatorVerified||e.IsGoogleAuthenticatorVerified){var o=document.createElement("input");o.setAttribute("type","button");var t=Ee.buttonsName["resetBackupCode".toLowerCase()]||De.resetBackupCode;o.setAttribute("value",t),Ne.addHTMLContent(b,o),Ne.addEvent("click",o,function(e){Ee.api.resetBackupCode(Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName),E,I)})}});break;case"updateSecurityQuestion":var s;s=setInterval(function(){var e,o,t,n,i,a,r;LoginRadiusDefaults.isSecurityFormSchemaLock||(LoginRadiusDefaults.isSecurityFormSchemaLock=!0,e=Pe,o=Le,t=Se,n=Re,Ee.options.securityQuestionEnabled&&(Ee.registrationFormSchema=Ee.registrationFormSchema&&0<Ee.registrationFormSchema.length?Ee.registrationFormSchema:Ee.options.RegistrationFormSchema,i=Ee.registrationFormSchema,a=!0,0<(r=Ke(i)).length&&(a=!1),a?t([Ie.setMappedMessage(Oe.noSecurityQuestions)]):Ie.createForm(r,"updatesecurityquestion",e,function(e){Ae.updateSecurityQuestionController(e,o,t)},function(e){t(e)},n)),clearInterval(s))},1e3);break;case"resetPasswordBySecurityQuestion":!function(n,i,a,r){if(Ee.options.securityQuestionEnabled){var e,s=!0;Ue(e=Ee.getSecQSchema),Ie.createForm(e,"securityquestions",n,function(e){e=Ne.checkPhoneOrEmailLogin(e),Ae.getSecurityQuestionsController(e,function(e){0<e.length&&(s=!1);var o=Ee.loginFormSchema.slice();Ie.setPasswordRule(Ee.util.findInSchema(o,"name","password")),Ie.setPasswordRule(Ee.util.findInSchema(o,"name","confirmpassword"));var t=Ne.mergeObjects(o,e);Ee.loginAction||Ue(t),s?a([Ie.setMappedMessage(Oe.noSecurityQuestions)]):Ie.createForm(t,"resetpwdbysecq",n,function(e){e=Ne.checkPhoneOrEmailLogin(e),Ae.resetPasswordBySecurityQuestionController(e,i,a)},function(e){a(e)},r)},function(e){a(e)})},function(e){a(e)},r)}}(Pe,Le,Se,Re);break;case"resetPINBySecurityQuestion":!function(n,i,a,r){if(Ee.options.securityQuestionEnabled){var e,s=!0;Ue(e=Ee.getSecQSchema),Ie.createForm(e,"securityquestions",n,function(e){e=Ne.checkPhoneOrEmailLogin(e),Ae.getSecurityQuestionsController(e,function(e){0<e.length&&(s=!1);var o=Ee.resetPINFormSchema.slice(0,1);o.push(Ee.loginFormSchema[0]),Ie.setPINRule(Ee.util.findInSchema(o,"name","pin"));var t=Ne.mergeObjects(o,e);Ee.loginAction||Ue(t),s?a([Ie.setMappedMessage(Oe.noSecurityQuestions)]):Ie.createForm(t,"resetpinbysecq",n,function(e){e=Ne.checkPhoneOrEmailLogin(e),Ae.resetPINBySecurityQuestionController(e,i,a)},function(e){a(e)},r)},function(e){a(e)})},function(e){a(e)},r)}}(Pe,Le,Se,Re);break;case"autoLogin":case"smartLogin":T=Pe,L=Le,S=Se,P=Re,Ue(R=Ee.smartLoginSchema),Ie.createForm(R,"smartlogin",T,function(e){var o=Ne.checkPhoneOrEmailLogin(e);-1!==o.indexOf("phone")?Ae.loginOTPController(o,T,L,S,P):Ae.smartLoginController(o,L,S)},function(e){S(e)},P);break;case"noRegistrationPasswordLessLogin":case"onetouchLogin":Qe(Pe,Le,Se,Re);break;case"ssoLogin":k=Le,Ie.validateAndCall(function(){var e=Ee.options.customDomain||Ee.options.appName+"."+LoginRadiusDefaults.hubDomain;Ne.ajaxCall("get","https://"+e+"/ssologin/login","",function(o){if(o.isauthenticated)if(Ee.loginRadiusHtml5PassToken)Ee.loginRadiusHtml5PassToken(o.token);else if(Ee.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,o.token),Ee.options.tokenType&&"jwt"===Ee.options.tokenType.toLowerCase()){LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={};Ie.getJwtToken(o.token,function(e){k(o.token,e)})}else k(o.token)})});break;case"logout":Ie.logout(Le);break;case"ssoNotLoginThenLogout":C=Se,w=Le,Ie.validateAndCall(function(){var e=Ee.options.customDomain||Ee.options.appName+"."+LoginRadiusDefaults.hubDomain;Ne.ajaxCall("get","https://"+e+"/ssologin/login","",function(o){if(o.isauthenticated){var e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie);if(void 0!==e&&null!=e||(Ie.setToken(o.token),e=LRNameSpace.cookies.getItem(LoginRadiusDefaults.tokenCookie)),e&&e!==o.token)Ie.setToken(o.token),w(o.token);else if(Ee.storage.setBrowserStorage(LoginRadiusDefaults.storedTokenName,o.token),Ee.options.tokenType&&"jwt"===Ee.options.tokenType.toLowerCase()){LoginRadiusDefaults.lrResponseCounter++,LoginRadiusDefaults.lrCounterTokenResponse={};Ie.getJwtToken(o.token,function(e){w(o.token,e)})}else w(o.token)}else LRNameSpace.cookies.removeItem(LoginRadiusDefaults.tokenCookie,Ee.options.appPath),C()})});break;case"instantLinkLogin":case"passwordlessLoginValidate":g=Le,f=Se,h=Re,v=Ne.getHashParam("vtoken"),"oneclicksignin"!==(y=Ne.getHashParam("vtype"))&&"passwordlesslogin"!==y||Ee.passwordlessLoginFlag||(Ee.passwordlessLoginFlag=!0,xe(v,g,f,h));break;case"pinreauthentication":n=Pe,u=Le,p=Se,d=Re,m=[],Ee.pinLoginFormSchema&&((m=Ee.pinLoginFormSchema.slice()).rules="required"),m.length?Ie.createForm(m,"pinreauthentication",n,function(e){Ae.pinReauthController(e,u,p)},function(e){p(e)},d):Ee.log("Pin schema is not defined");break;case"customeventconsent":i=Pe,a=Te.event,r=Le,l=Se,c=Re,Ee.getConsentConfiguration(function(e){var o=[],t=Ie.createConsentInterface(e["custom_"+a]);if(""!==t){var n={html:t,name:"consent",type:"html"};o.push(n),Ie.createForm(o,"customeventconsent",i,function(e){var o=Ie.consentValidation(e,"custom_"+a);if(0<o.length)l(o);else{var t=[],n=Ie.mapRegistrationSchema(null,e).Consents;t.push({Event:a,IsCustom:!0}),n.Events=t,Ae.customEventConsentController(n,r,l)}},function(e){l(e)},c)}});break;case"consenteditor":qe(Pe,Le,Se,Re);break;default:Ee.log("This action is not valid.")}var i,a,r,l,c,n,u,p,d,m,g,f,h,v,y,C,w,k,T,L,S,P,R,b,E,I,A,D,O,F,N,x,j,_,M,B,V,K,U,Q,q,H,$,G,J,z,W,Z,X,Y,ee,oe,te,ne,ie,ae,re,se,le,ce,ue,pe,de,me,ge,fe,he,ve,ye,Ce,we})}return this.trackEvent=function(){Ee.options.debugMode&&console.warn("Anonymous login feature has been deprecated")},Ne.unLinkAccount=function(e,o,t,n){if(t=t||function(){},n=n||function(){},e&&o){var i={provider:e,providerid:o},a=Ee.storage.getBrowserStorage(LoginRadiusDefaults.storedTokenName);a?Ne.ajaxCall("delete",LoginRadiusDefaults.apiDomain+"/auth/socialIdentity?apiKey="+Ee.options.apiKey+"&access_token="+a,i,function(e){e.ErrorCode?n(Ie.loginRadiusErrorTojsError(e)):t(e,i)},"unLinkAccount"):n([Ie.setMappedMessage(Oe.tokenValid)])}},LoginRadiusHooksModel(Ee),setLoginRadiusModuleFunctions(Ee,t),Ee.init=function(e,o){Ee.useraction=e,t.maskSensitiveInput?Ee.otpSchema=[{type:"password",name:"otp",display:"OTP",rules:"required",permission:"r"}]:Ee.otpSchema=[{type:"string",name:"otp",display:"OTP",rules:"required",permission:"r"}],"required"===t.twoFactorAuthentication?(t.twoFactorAuthentication=!0,t.optionalTwoFactorAuthentication=!1):"optional"===t.twoFactorAuthentication&&(t.twoFactorAuthentication=!1,t.optionalTwoFactorAuthentication=!0),"ssoLogin"!==e&&"logout"!==e&&"ssoNotLoginThenLogout"!==e||LoginRadiusDefaults.isSSOInitFired||(LoginRadiusDefaults.isSSOInitFired=!0,Ee.SSOinitFired=!0),t.appName||Ee.log("SSO will not work, please set option.appName for SSO"),t.formRenderDelay=t.formRenderDelay||0,t.apiKey?0<t.formRenderDelay?setTimeout(function(){n(e,o)},t.formRenderDelay):n(e,o):Ee.log("API key must be set.")},setLoginRadiusDefaultSchema(Ee),Ee.api=new LoginRadiusApiFramework(Ee,Ae),Ee};